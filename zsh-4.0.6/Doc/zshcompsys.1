.TH "ZSHCOMPSYS" "1" "August 14, 2002" "zsh 4\&.0\&.6"
.SH "NAME"
zshcompsys \- zsh completion system
.\" Yodl file: Zsh/compsys.yo
.SH "DESCRIPTION"
.PP
This describes the shell code for the new completion system\&.  It consists
of various shell functions; those beginning `\fBcomp\fP' are to be called
directly by the user, while those beginning `\fB_\fP' are called by the
completion code\&.  The shell functions of the second set which implement
completion behaviour and which may be bound to keystrokes, are referred to
as `widgets'\&.
.PP
.PP
.SH "INITIALIZATION"
.PP
If the system was installed completely, it should be enough to
call the shell function \fBcompinit\fP from your initialization file; see the
next section\&.  However, the function \fBcompinstall\fP can be run by a user
to configure various aspects of the completion system\&.
.PP
Usually, \fBcompinstall\fP will insert code into \fB\&.zshrc\fP, although if
that is not writable it will save it in another file and tell you that
file's location\&.  Note that it is up to you to make sure that the lines
added to \fB\&.zshrc\fP are actually run; you may, for example, need to move
them to an earlier place in the file if \fB\&.zshrc\fP usually returns early\&.
So long as you keep them all together (including the comment lines at the
start and finish), you can rerun \fBcompinstall\fP and it will correctly
locate and modify these lines\&.  Note, however, that any code you add to
this section by hand is likely to be lost if you rerun \fBcompinstall\fP,
although lines using the command `\fBzstyle\fP' should be gracefully handled\&.
.PP
The new code will take effect next time you start the shell, or run
\fB\&.zshrc\fP by hand; there is also an option to make them take effect
immediately\&.  However, if \fBcompinstall\fP has removed definitions, you will
need to restart the shell to see the changes\&.
.PP
To run \fBcompinstall\fP you will need to make sure it is in a directory
mentioned in your \fBfpath\fP parameter, which should already be the case if
zsh was properly configured as long as your startup files do not remove the
appropriate directories from \fBfpath\fP\&.  Then it must be autoloaded
(`\fBautoload \-U compinstall\fP' is recommended)\&.  You can abort the
installation any time you are being prompted for information, and your
\fB\&.zshrc\fP will not be altered at all; changes only take place right at the
end, where you are specifically asked for confirmation\&.
.PP
.SS "Use of compinit"
.PP
This section describes the use of \fBcompinit\fP to initialize completion for
the current session when run directly by the user; if you have run
\fBcompinstall\fP it will be called automatically from your \fB\&.zshrc\fP\&.
.PP
To initialize the system, the function \fBcompinit\fP should be in a
directory mentioned in the \fBfpath\fP parameter, and should be autoloaded
(`\fBautoload \-U compinit\fP' is recommended), and then run simply as
`\fBcompinit\fP'\&.  This will define a
few utility functions, arrange for all the necessary shell functions to be
autoloaded, and will then re\-define all widgets that do completion to use the
new system\&.  If you use the \fBmenu\-select\fP widget, which is part of the
\fBzsh/complist\fP module, you should make sure that that module is loaded
before the call to \fBcompinit\fP so that that widget is also
re\-defined\&.  If completion styles (see below) are set up to perform
expansion as well as completion by default, and the TAB key is bound to
\fBexpand\-or\-complete\fP, \fBcompinit\fP will rebind it to \fBcomplete\-word\fP;
this is necessary to use the correct form of expansion\&.
.PP
Should you need to use the original completion commands, you can still
bind keys to the old widgets by putting a `\fB\&.\fP' in front of the
widget name, e\&.g\&. `\fB\&.expand\-or\-complete\fP'\&.
.PP
To speed up the running of \fBcompinit\fP, it can be made to produce a dumped
configuration which will be read in on future invocations; this is the
default, although it can be turned off by calling \fBcompinit\fP with the
option \fB\-D\fP\&.  The dumped file is \fB\&.zcompdump\fP in the same
directory as the startup files (i\&.e\&. \fB$ZDOTDIR\fP or \fB$HOME\fP);
alternatively, an explicit file name can be given by `\fBcompinit \-d\fP
\fIdumpfile\fP'\&.  On the next call to \fBcompinit\fP, it will read the dumped
file instead of performing a full initialization\&.
.PP
If the number of completion files changes, \fBcompinit\fP will recognise this
and produce a new dump file\&.  However, if the name of a function or the
arguments in the first line of a \fB#compdef\fP function (as described below)
change, it is easiest to delete the dump file by hand so that
\fBcompinit\fP will re\-create it the next time it is run\&.  The check
performed to see if there are new functions can be omitted by giving
the option \fB\-C\fP\&.  In this case the dump file will only be created if
there isn't one already\&.
.PP
The dumping is actually done by another function, \fBcompdump\fP, but you
will only need to run this yourself if you change the configuration
(e\&.g\&. using \fBcompdef\fP) and then want to dump the new one\&.  The name of
the old dumped file will be remembered for this purpose\&.
.PP
If the parameter \fB_compdir\fP is set, \fBcompinit\fP uses it as a directory
where completion functions can be found; this is only necessary if they are
not already in the function search path\&.
.PP
For security reasons \fBcompinit\fP also checks if the completion system
would use files not owned by root or by the current user, or files in
directories that are world\- or group\-writable or that are not owned by 
root or by the current user\&.  If such files or directories are found,
\fBcompinit\fP will ask if the completion system should really be used\&.  To
avoid these tests and make all files found be used without asking, use the
option \fB\-u\fP, and to make \fBcompinit\fP silently ignore all insecure files
and directories use the option \fB\-i\fP\&.  This security check is skipped
entirely when the \fB\-C\fP option is given\&.
.PP
The security check can be retried at any time by running the function
\fBcompaudit\fP\&.  This is the same check used by \fBcompinit\fP, but when it
is executed directly any changes to \fBfpath\fP are made local to the
function so they do not persist\&.  The directories to be checked may be
passed as arguments; if none are given, \fBcompaudit\fP uses \fBfpath\fP and
\fB_compdir\fP to find completion system directories, adding missing ones
to \fBfpath\fP as necessary\&.  To force a check of exactly the directories
currently named in \fBfpath\fP, set \fB_compdir\fP to an empty string before
calling \fBcompaudit\fP or \fBcompinit\fP\&.
.PP
.SS "Autoloaded files"
.PP
The convention for autoloaded functions used in completion is that they
start with an underscore; as already mentioned, the \fBfpath/FPATH\fP
parameter must contain the directory in which they are stored\&.  If \fBzsh\fP
was properly installed on your system, then \fBfpath/FPATH\fP automatically
contains the required directories for the standard functions\&.
.PP
For incomplete installations, if \fBcompinit\fP does not find enough files
beginning with an underscore (fewer than twenty) in the search path, it
will try to find more by adding the directory \fB_compdir\fP to the search
path\&.  If that directory has a subdirectory named \fBBase\fP, all
subdirectories will be added to the path\&.  Furthermore, if the subdirectory
\fBBase\fP has a subdirectory named \fBCore\fP, \fBcompinit\fP will add all
subdirectories of the subdirectories is to the path: this allows
the functions to be in the same format as in the \fBzsh\fP source
distribution\&.
.PP
When \fBcompinit\fP is run, it searches all such files accessible via
\fBfpath/FPATH\fP and reads the first line of each of them\&.  This line should
contain one of the tags described below\&.  Files whose first line does not
start with one of these tags are not considered to be part of the
completion system and will not be treated specially\&.
.PP
The tags are:
.PP
.PD 0
.TP
.PD
\fB#compdef\fP \fInames\&.\&.\&.\fP
The file will be made autoloadable and the function defined 
in it will be called when completing \fInames\fP, each of which is
either the name of a command whose arguments are to be completed or one of
a number of special contexts in the form \fB\-\fP\fIcontext\fP\fB\-\fP described
below for the \fB_complete\fP function\&.
.RS
.PP
Each \fIname\fP may also be of the form `\fIcmd\fP\fB=\fP\fIservice\fP'\&.  This
is used by functions that offer multiple services, i\&.e\&. different
completion behaviour for multiple commands\&.  Such a string
makes the completion system call the function when completing
arguments for the command `\fBcmd\fP', setting the parameter \fB$service\fP 
to the string `\fBservice\fP'\&.  The function can then use that parameter 
to decide what to complete\&.
.RE
.TP
\fB#compdef \-p\fP \fIpattern\fP
The file will be made autoloadable and the function defined in it will be
called when completing for a command whose name matches the given
\fIpattern\fP (a standard globbing pattern)\&.  Note that only one
\fIpattern\fP may be given\&.
.TP
\fB#compdef \-P\fP \fIpattern\fP
Like the previous one, but the function will be called only if no
completion function for the command on the line could be found\&.
.TP
\fB#compdef \-k\fP \fIstyle key\-sequences\&.\&.\&.\fP
This can be used to bind special completion functions to the
\fIkey\-sequences\fP specified\&.  It creates a widget behaving like the
builtin widget \fIstyle\fP, which must be one of those that perform
completion, namely \fBcomplete\-word\fP, \fBdelete\-char\-or\-list\fP,
\fBexpand\-or\-complete\fP, \fBexpand\-or\-complete\-prefix\fP, \fBlist\-choices\fP,
\fBmenu\-complete\fP, \fBmenu\-expand\-or\-complete\fP, or
\fBreverse\-menu\-complete\fP\&.  If the \fBzsh/complist\fP module is loaded (see
\fIzshmodules\fP(1)), the same happens to the \fBmenu\-select\fP widget\&.
.RS
.PP
The widget is then bound to all the \fIkey\-sequences\fP given, if any: when
one of the \fIkey\-sequences\fP is typed, the function in the file will
be invoked to generate the matches\&.  Note that a key will not be re\-bound
if if it already was (that is, was bound to something other than
\fBundefined\-key\fP)\&.  The widget created has the same name as the file and
can be bound to any other keys using \fBbindkey\fP as usual\&.
.RE
.TP
\fB#compdef \-K\fP \fIwidget\-name\fP \fIstyle\fP \fIkey\-sequences\fP \&.\&.\&.
This is similar to \fB\-k\fP, with the same \fIstyle\fP and \fIkey\-sequences\fP
arguments, preceded by a string giving the name of a widget\&.
In this case only one \fIkey\-sequences\fP argument may be given, but the
entire set of three arguments may be repeated with a different set of
arguments\&.  In particular, the \fIwidget\-name\fP must be distinct in each
set\&.  It should begin with `\fB_\fP', else one will be added, and should not
clash with the name of any existing widget: names based on the name of the
function are most useful\&.  For example,
.RS
.PP
.RS
.nf
\fB#compdef \-K _foo_complete complete\-word "^X^C" \e 
  _foo_list list\-choices "^X^D"\fP
.fi
.RE
.PP
(all on one line) defines a widget \fB_foo_complete\fP for completion, bound
to `\fB^X^C\fP', and a widget \fB_foo_list\fP for listing, bound to `\fB^X^D\fP'\&.
.RE
.TP
\fB#autoload\fP [ \fIoptions\fP ]
This is used for files defining utility functions that are not to be
called directly as completion functions but should be loaded automatically
when invoked\&.  Typically they are to be called from within one of the
completion functions\&.
.RS
.PP
The \fIoptions\fP will be given to the \fBautoload\fP builtin command
when making the function autoloaded\&.  Most often, this will be \fB+X\fP to
force the function to be loaded immediately\&.  Note that the \fB\-U\fP flag is
always implicitly added\&.
.RE
.RE
.PP
The \fB#\fP is part of the tag name and no white space is allowed after it\&.
The \fB#compdef\fP tags use the \fBcompdef\fP function described below; the
main difference is that the name of the function is supplied implicitly\&.
.PP
Note also that the functions for the completion system assume that the
\fBKSH_AUTOLOAD\fP option is not set and cannot be loaded when it is
set\&.  To avoid having to unset \fBKSH_AUTOLOAD\fP, you can instead use one or
more \fBzwc\fP file(s) which have been created with the command \fBzcompile
\-z\fP to load the functions for the completion system; see
\fIzshbuiltins\fP(1)\&.  This forces the functions to be autoloaded the way zsh normally
loads functions\&.
.PP
.SS "Functions"
.PP
The \fBcompinit\fP file defines the following function, which may
also be called directly by the user\&.
.PP
.PD 0
.TP
.PD 0
\fBcompdef\fP [ \fB\-an\fP ] \fIfunction names\&.\&.\&.\fP
.TP
.PD 0
\fBcompdef \-d\fP \fInames\&.\&.\&.\fP
.TP
.PD 0
\fBcompdef \-p\fP [ \fB\-a\fP ] \fIfunction pattern\fP
.TP
.PD 0
\fBcompdef \-P\fP [ \fB\-a\fP ] \fIfunction pattern\fP
.TP
.PD 0
\fBcompdef \-k\fP [ \fB\-an\fP ] \fIfunction style key\-sequences\&.\&.\&.\fP
.TP
.PD
\fBcompdef \-K\fP [ \fB\-an\fP ] \fIfunction name style key\-sequences \&.\&.\&.\fP
The first form tells the completion system to call the given
\fIfunction\fP when completing for the contexts or commands
whose \fInames\fP are given:  this is like the \fB#compdef\fP tag unless
the first word contains an equal sign\&.  In this case all words have to 
be of the form `\fIcmd\fP\fB=\fP\fIservice\fP' where \fIservice\fP is the
name of a command or of a service defined by an autoloaded function
with the \fB#compdef\fP tag and an argument of the form
`\fIcmd\fP\fB=\fP\fIservice\fP'\&.  This kind of use makes the arguments of
the \fIcmd\fPs be completed as those for the \fIservices\fP\&.
.RS
.PP
If the
\fB\-n\fP option is given, any existing completion behaviour for particular
contexts or commands will not be altered\&.  These definitions can be deleted
by giving the \fB\-d\fP option as in the second form\&.
.PP
The form with \fB\-p\fP is similar to the first, but \fIfunction\fP will be
called for all commands whose name matches the \fIpattern\fP; this is like
the \fB#compdef \-p\fP function tag\&.
.PP
The form with \fB\-P\fP is like the third, but the \fIfunction\fP will be
called only if no function for the command itself was found or if one
was found and it set the \fB_compskip\fP parameter to a value \fInot\fP
containing the substring \fBpatterns\fP\&.
.PP
The form with \fB\-k\fP defines a widget with the same name as the \fIfunction\fP
which will be called for each of the \fIkey\-sequences\fP; this is like the
\fB#compdef \-k\fP tag\&.  The function should generate the completions needed
and will otherwise behave like the builtin widget whose name is given as
the \fIstyle\fP argument\&. The widgets usable for this are:
\fBcomplete\-word\fP, \fBdelete\-char\-or\-list\fP, \fBexpand\-or\-complete\fP,
\fBexpand\-or\-complete\-prefix\fP, \fBlist\-choices\fP, \fBmenu\-complete\fP,
\fBmenu\-expand\-or\-complete\fP, and \fBreverse\-menu\-complete\fP, as well as
\fBmenu\-select\fP if the \fBzsh/complist\fP module is loaded\&.  The option \fB\-n\fP
prevents the key being bound if it is already to bound to something other
than \fBundefined\-key\fP\&.
.PP
The form with \fB\-K\fP is similar and defines multiple widgets based on the
same \fIfunction\fP, each of which requires the set of three arguments
\fIname\fP, \fIstyle\fP and \fIkey\-sequences\fP, where the latter two are as
for \fB\-k\fP and the first must be a unique widget name beginning with an
underscore\&.
.PP
In each of the forms supporting it the \fB\-a\fP option makes the
\fIfunction\fP autoloadable (exactly equivalent to
\fBautoload \-U \fP\fIfunction\fP)\&.
.RE
.RE
.PP
The \fBcompdef\fP function is the place to turn to when one wants to
define what the completion system should complete for a certain
command\&.  The function named can of course be one of the functions
supplied or one written by the user\&.  For example, if one has a
command \fBfoo\fP that gets process identifiers as arguments, one could
do:
.PP
.RS
.nf
\fBcompdef _pids foo\fP
.fi
.RE
.PP
using the \fB_pids\fP function from the distribution to generate the
process identifiers\&.  Not also the \fB_gnu_generic\fP function described
below, which can be used to complete options for commands that
understand the `\fB\-\fP\fB\-help\fP' option\&.
.PP
.SH "COMPLETION SYSTEM CONFIGURATION"
.PP
This section gives a short overview of how the completion system works,
and then more detail on how users can configure how and when matches are
generated\&.
.PP
.SS "Overview"
.PP
When completion is attempted somewhere on a command line the
completion system first tries to find out the context where completion 
was tried\&.  The context depends on such things as the name of the
command when completing an argument, and possibly also
the name of an option when completing an argument to that option\&.
.PP
The `context' of a completion is a string consisting of multiple fields\&. This
is used to look up styles that can be used to configure the
completion system\&.  Since it is not possible to build the whole context 
string in advance, completion functions may modify some of the fields and 
hence the context used for lookup may vary during the same call
to the completion system\&.
.PP
The context string always consists of the following fields, separated
by colons and with a leading colon before the first:
.PP
.PD 0
.TP
.PD
\(bu
The literal string \fBcompletion\fP, saying that this style is used by
the completion system\&.

.TP
\(bu
The \fIfunction\fP; in many cases this field will be blank, but when
the completion system is called from other functions, like
\fBpredict\-on\fP or one of the functions in the \fBCommand\fP directory of 
the distribution, this field contains the name of that function, often
in an abbreviated form\&.

.TP
\(bu
The \fIcompleter\fP currently active, which is the name of the function
without the leading underscore\&.  A `completer' is in
overall control of how completion is to be performed; `\fBcomplete\fP'
is the basic one for ordinary completion, but completers may perform
various related tasks such as correction, or modify the behaviour of a
later completer (see
the section `Control Functions' below 
for more information)\&.  

.TP
\(bu
The \fIcontext\fP or \fIcommand\fP\&.  This is either one of the special
context names such as \fB\-condition\-\fP as explained for the
\fB_complete\fP completer below, or the name of the command we are
completing arguments for\&.  Completion functions for commands that have
sub\-commands usually modify this field to contain the name of the
command followed by a minus sign and the sub\-command (e\&.g\&. the
completion function for the \fBcvs\fP command sets this field to strings
such as \fBcvs\-add\fP when completing for the \fBadd\fP sub\-command)\&.

.TP
\(bu
The \fIargument\fP, describing which argument we are
completing\&.  Normally this is either a string of the form
\fBargument\-\fP\fIn\fP, where \fIn\fP is the number of the argument or it
is a string of the form \fBoption\-\fP\fIopt\fP\fB\-\fP\fIn\fP when completing the
\fIn\fP'th argument of the option \fIopt\fP\&.

.TP
\(bu
The \fItag\fP\&.  Tags are used to discriminate between the types
of matches a completion function can generate in a certain context\&.

.PP
As an example, the context name
.PP
.RS
.nf
\fB\fB:completion::complete:dvips:option\-o\-1:files\fP\fP
.fi
.RE
.PP
says that normal completion was attempted on an argument of the \fBdvips\fP
command (more precisely: completion was attempted on the first argument
after the \fB\-o\fP option) and the completion function will generate
filenames for this context\&.
.PP
In many of the possible contexts the completion system can generate
matches, often multiple types of matches\&.  These types are represented as
simple names called `tags'\&.  The completion system will decide internally
what sort of tags are allowed; a list of the standard possibilities is given
below\&.  To determine in which order the tags are to be used by the
completion function, the `\fBtag\-order\fP' style for the appropriate
context may be set, as described in the list of standard styles below\&.
Only those types of matches whose tags were selected by this style
will be produced, and in the order given, although the default is to try
all relevant tags in an order determined by the particular completion in
use\&.
.PP
The \fB_complete_help\fP bindable command described in 
the section `Bindable Commands' below
can be invoked to find out the context and tag names and styles used at a
particular point in completion\&.  It shows the list of contexts and tags 
that would be used in if completion were tried at the current cursor
position\&.  Hence one can easily find out all the information needed to
change the behaviour of the \fBtag\-order\fP style for a particular context\&.
.PP
Completion behaviour can be modified by various other
styles defined with the \fBzstyle\fP builtin command (see \fIzshmodules\fP(1))\&.
When looking up styles the completion system uses full context names,
including the tag\&.
.PP
Styles determine such things as how the matches are generated; some of them
correspond to shell options (for example, the use of menu completion), but
styles provide more specific control\&.  They can have any number of strings as
their value\&.  Looking up the value of a style therefore consists of two
things:  the context, which may be matched as a pattern, and the name of
the style itself, which must be given exactly\&.
.PP
For example, many completion functions can generate matches in a
simple and a verbose form and use the \fBverbose\fP style to decide
which form should be used\&.  To make all such functions use the verbose form,
put
.PP
.RS
.nf
\fBzstyle ':completion:*' verbose yes\fP
.fi
.RE
.PP
in one of the startup files like \fB\&.zshrc\fP; this sort of style can also be
configured with the \fBcompinstall\fP function\&.  This definition simply
means that the \fBverbose\fP style has \fByes\fP as its value in every
context inside the completion system\&.  If the context pattern were `\fB*\fP',
the verbose style would have this value anywhere the style mechanism is
used, not just in completion\&.
.PP
As a more specific example, the completion function for the \fBkill\fP
builtin command uses the \fBverbose\fP style to decide if jobs and processes
are listed only as job numbers and process identifiers or if they are
listed with the full job texts and the command lines of the processes (the
latter is achieved by calling the \fBps\fP command)\&.  To make this builtin
list the matches only as numbers one could call:
.PP
.RS
.nf
\fBzstyle ':completion:*:*:kill:*' verbose no\fP
.fi
.RE
.PP
Furthermore, if one wanted to see the command lines for processes but not the
job texts one could use the fact that the context name contains the tag name
when styles are looked up\&.  As the function for the \fBkill\fP
builtin command uses the tags \fBjobs\fP and \fBprocesses\fP, we can use:
.PP
.RS
.nf
\fBzstyle ':completion:*:*:kill:*:jobs' verbose no\fP
.fi
.RE
.PP
To have more control over when certain values for styles are used one
can use the special parameters available in completion widgets (see
see \fIzshcompwid\fP(1))) and the \fB\-e\fP option to \fBzstyle\fP that makes the value be
evaluated when looked up\&.  For example, to make the \fBcompleter\fP
style have a different value when completing for the \fBcvs\fP command,
one could use the \fBwords\fP special array:
.PP
.RS
.nf
\fBzstyle \-e ':completion:*' completer '
    if [[ $words[1] = cvs ]]; then
      reply=(_complete)
    else
      reply=(_complete _approximate)
    fi'\fP
.fi
.RE
.PP
One should be careful not to use too complicated code with this
option, at least for the styles that are looked up quite often\&.  These 
are basically those that define some global completion behaviour but
allow that to be different for all matches or groups of matches (such
as the \fBmenu\fP and \fBlist\-rows\-first\fP styles)\&.  Alternatively one
can always use a less general pattern for the context than in the
example above and use a second call to \fBzstyle\fP with a generic
pattern and without using the \fB\-e\fP option to define the default
behaviour\&.
.PP
Note that the order in which styles are \fIdefined\fP does not matter; the
style mechanism uses the most specific possible match for a particular
style to determine the set of values\&.  More precisely, strings are
preferred over patterns (for example, `\fB:completion::complete:foo\fP' is
more specific than `\fB:completion::complete:*'\fP), and longer patterns are
preferred over shorter patterns\&.
.PP
As with tags, completion functions can use any style they choose, so
there can't be a complete list\&.  However, the following two sections
list those tags and styles that are used in many places of the
completion system\&.
.PP
.SS "Standard Tags"
.PP
Here are the tags currently used by the completion system\&.  Some of them
are only used when looking up styles and do not refer to a particular type
of match\&.
.PP
.PD 0
.TP
.PD
\fBaccounts\fP
used to look up the \fBusers\-hosts\fP style
.TP
\fBall\-expansions\fP
used by the \fB_expand\fP completer when adding the single string containing
all possible expansions
.TP
\fBall\-files\fP
for the names of all files (as distinct from a particular subset, see the
\fBglobbed\-files\fP tag)\&.
.TP
\fBarguments\fP
when an argument of a command may be completed
.TP
\fBarrays\fP
for names of array parameters
.TP
\fBassociation\-keys\fP
for keys of associative arrays; used when completing inside a
subscript of a parameter of this type
.TP
\fBbookmarks\fP
when completing bookmarks (e\&.g\&. for URLs and the \fBzftp\fP function suite)
.TP
\fBbuiltins\fP
for names of builtin commands
.TP
\fBcharacters\fP
used for commands like \fBstty\fP when completing characters; also used
when completing character classes after an opening bracket
.TP
\fBcolormapids\fP
for X colormap ids
.TP
\fBcolors\fP
for color names
.TP
\fBcommands\fP
for names of external commands and names of sub\-commands (used by some 
commands like \fBcvs\fP)
.TP
\fBcontexts\fP
for contexts used by the zstyle builtin command
.TP
\fBcorrections\fP
used by the \fB_approximate\fP and \fB_correct\fP completers for the possible
corrections
.TP
\fBcursors\fP
for cursor names used by X programs
.TP
\fBdefault\fP
used to look up default values for various styles that may also be set 
for tags that are used when generating matches; note that this tag is
used when only the \fIfunction\fP field of the context name is set up
.TP
\fBdescriptions\fP
used when looking up the value of the \fBformat\fP style for
descriptions
.TP
\fBdevices\fP
for names of device special files
.TP
\fBdirectories\fP
for names of directories
.TP
\fBdirectory\-stack\fP
for entries in the directory stack
.TP
\fBdisplays\fP
for X display names
.TP
\fBdomains\fP
for network domains
.TP
\fBexpansions\fP
used by the \fB_expand\fP completer for individual possibilities resulting
from expansion of a word
.TP
\fBextensions\fP
for X server extensions
.TP
\fBfile\-descriptors\fP
for the numbers of open file descriptors
.TP
\fBfiles\fP
the generic file\-matching tag used by completion functions that can
complete the names of some kind of file
.TP
\fBfonts\fP
used for X font names
.TP
\fBfunctions\fP
names of functions, normally shell functions although certain commands may
understand other kinds of function
.TP
\fBglobbed\-files\fP
for names of files matching the glob pattern used by completion
functions that expect a certain type of file
.TP
\fBgroups\fP
used when completing names of user groups
.TP
\fBhistory\-words\fP
for words from the history
.TP
\fBhosts\fP
for hostnames
.TP
\fBindexes\fP
used for array indexes
.TP
\fBjobs\fP
used for jobs
.TP
\fBkeymaps\fP
for names of zsh keymaps
.TP
\fBkeysyms\fP
for names of X keysyms
.TP
\fBlibraries\fP
for names of system libraries
.TP
\fBlimits\fP
for system limits
.TP
\fBlocal\-directories\fP
for names of directories which are subdirectories of the current working
directory when completing for the \fBcd\fP and related builtin commands
.TP
\fBmanuals\fP
for names of manual pages
.TP
\fBmaps\fP
for map names (e\&.g\&. NIS maps)
.TP
\fBmessages\fP
used to look up the \fBformat\fP style for messages
.TP
\fBmodifiers\fP
for names of X modifiers
.TP
\fBmodules\fP
for modules (e\&.g\&. \fBzsh\fP modules)
.TP
\fBmy\-accounts\fP
used to look up the \fBusers\-hosts\fP style
.TP
\fBnamed\-directories\fP
for named directories (you wouldn't have guessed that, would you?)
.TP
\fBnames\fP
for all kinds of names
.TP
\fBnicknames\fP
for nicknames of NIS maps
.TP
\fBoptions\fP
for command options
.TP
\fBoriginal\fP
used by the \fB_approximate\fP, \fB_correct\fP and \fB_expand\fP completers when
adding the original string
.TP
\fBother\-accounts\fP
used to look up the \fBusers\-hosts\fP style
.TP
\fBpackages\fP
for packages (e\&.g\&. \fBrpm\fP or installed \fBDebian\fP packages)
.TP
\fBparameters\fP
for names of parameters
.TP
\fBpath\-directories\fP
for names of directories found by searching the \fBcdpath\fP array when
completing for the \fBcd\fP and related builtin commands
.TP
\fBpaths\fP
used to look up the values of the \fBexpand\fP, \fBambiguous\fP and
\fBspecial\-dirs\fP styles
.TP
\fBpods\fP
for perl pods (documentation files)
.TP
\fBports\fP
for communication ports
.TP
\fBprefixes\fP
for prefixes (like those of a URL)
.TP
\fBprinters\fP
for printer names
.TP
\fBprocesses\fP
for process identifiers
.TP
\fBprocesses\-names\fP
used to look up the \fBcommand\fP style when generating the names of
processes for \fBkillall\fP
.TP
\fBsequences\fP
for sequences (e\&.g\&. \fBmh\fP sequences)
.TP
\fBsessions\fP
for sessions in the \fBzftp\fP function suite
.TP
\fBsignals\fP
for signal names
.TP
\fBstrings\fP
for strings (e\&.g\&. the replacement strings for the \fBcd\fP builtin
command)
.TP
\fBstyles\fP
for styles used by the zstyle builtin command
.TP
\fBtags\fP
for tags (e\&.g\&. \fBrpm\fP tags)
.TP
\fBtargets\fP
for makefile targets
.TP
\fBtypes\fP
for types of whatever (e\&.g\&. address types for the \fBxhost\fP command)
.TP
\fBurls\fP
used to look up the \fBurls\fP and \fBlocal\fP styles when completing URLs
.TP
\fBusers\fP
for usernames
.TP
\fBvalues\fP
when completing a value out of a set of values (or a list of such
values)
.TP
\fBversion\fP
used by \fB_call_program\fP to look up the command to run to determine the installed
version of various other commands (such as \fBdiff\fP and \fBmake\fP)\&.
.TP
\fBwarnings\fP
used to look up the \fBformat\fP style for warnings
.TP
\fBwidgets\fP
for zsh widget names
.TP
\fBwindows\fP
for IDs of X windows
.TP
\fBzsh\-options\fP
for shell options
.PP
.SS "Standard Styles"
.PP
Here are the names of the styles used by the completion system\&.  Note
that the values of several of these styles represent boolean
values; here, any of the strings `\fBtrue\fP', `\fBon\fP',
`\fByes\fP', and `\fB1\fP' can be used for the truth value `true' and
the strings `\fBfalse\fP', `\fBoff\fP', `\fBno\fP', and `\fB0\fP' are
interpreted as `false'\&.  The behavior for any other value is undefined 
unless the description for the particular style mentions other
possible values; in particular, the default value may be either on or off
if the style is not set\&.
.PP
Some of these styles are tested for every tag used to add possible
matches and for the \fBdefault\fP tag (most notably \fBmenu\fP,
\fBlist\-colors\fP and the styles controlling the completion listing like 
\fBlist\-packed\fP and \fBlast\-prompt\fP)\&. When tested for the \fBdefault\fP
tag, only the \fIfunction\fP field of the context will be set up, so
the default value will normally be set like:
.PP
.RS
.nf
\fBzstyle ':completion:*:default' menu \&.\&.\&.\fP
.fi
.RE
.PP
.PD 0
.TP
.PD
\fBaccept\-exact\fP
This is tested for the default tag and the tags used when generating
matches\&.  If it is set to `true' for at least one match which is the
same as the string on the line, this match will immediately be
accepted\&.
.RS
.PP
When completing pathnames (where it is looked up for the \fBpaths\fP
tag), this style also accepts any number of patterns as the value\&. If
this is used, pathnames matching one of these patterns will be
accepted immediately even if the command line contains some more
partially typed pathname components and these match no file under the
directory accepted\&.
.PP
Note that this is also used by the \fB_expand\fP completer to decide if
words beginning with a tilde or parameter expansion should be
expanded\&. This means that if, for example, there are parameters
\fBfoo\fP and \fBfoobar\fP, the string `\fB$foo\fP' will only be expanded if 
\fBaccept\-exact\fP is set to `true'\&.
.RE
.TP
\fBadd\-space\fP
This style is used by the \fB_expand\fP completer\&.  If it is `true' (the
default), a space will be inserted after all words resulting from the 
expansion (except for directory names which get a slash)\&.  The value
may also be the string `\fBfile\fP' to make the completer add a space
only to names of existing files\&.  Finally, the `true' values and
`\fBfile\fP' may be combined with `\fBsubst\fP' to keep the completer from 
adding a space when the resulting words were generated by expanding a
substitution of the form `\fB$(\&.\&.\&.)\fP' or `\fB${\&.\&.\&.}\fP'\&.
.RS
.PP
It is also used by the \fB_prefix\fP completer as a simple boolean value
to decide if a space should be inserted before the suffix\&.
.RE
.TP
\fBambiguous\fP
This applies when completing non\-final components of filename paths\&.
If it is set, the cursor is left after the first ambiguous component, even
if menu completion is in use\&.  It is tested with the \fBpaths\fP tag\&.
.TP
\fBassign\-list\fP
When completing after an equals sign, the completion system normally
completes only one filename\&.  In some cases, particularly for certain
parameters such as \fBPATH\fP, a list of filenames separated by colons is
required\&.  This style can be set to a list of patterns matching the names
of such parameters\&.
.RS
.PP
The default is to complete lists when the word on the line already
contains a colon\&.
.RE
.TP
\fBauto\-description\fP
If set, this style's value will be used as the description for options which
are not described by the completion functions, but that have exactly
one argument\&.  The sequence `\fB%d\fP' in the value will be replaced by
the description for this argument\&.  Depending on personal preferences,
it may be useful to set this style to something like `\fBspecify: %d\fP'\&. 
Note that this may not work for some commands\&.
.TP
\fBavoid\-completer\fP
This is used by the \fB_all_matches\fP completer to decide if the string 
consisting of all matches should be added to the list currently being
generated\&.  Its value is a list of names of completers\&.  If any of
these is the name of the completer that generated the matches in this
completion, the string will not be added\&.
.RS
.PP
The default value for this style is `\fB_expand _old_list _correct
_approximate\fP', i\&.e\&. it contains the completers for which a string
with all matches will almost never be wanted\&.
.RE
.TP
\fBcache\-path\fP
This style defines the path where any cache files containing dumped
completion data are stored\&.  Defaults to `\fB$ZDOTDIR/\&.zcompcache\fP', or
`\fB$HOME/\&.zcompcache\fP' if \fB$ZDOTDIR\fP is not defined\&.  The completion
layer will not be used unless the \fBuse\-cache\fP style is set\&.
.TP
\fBcall\-command\fP
Currently this is only used by the function completing \fBmake\fP
targets\&.  If it is set to `true' and the installed version of the
\fBmake\fP command allows it, \fBmake\fP is called in a way to generate
all possible targets\&.  The default value of this style is `false'
because calling \fBmake\fP can potentially take a very long time and in
some cases may even cause actions from the makefile be executed
despite the options given to \fBmake\fP\&.
.TP
\fBcommand\fP
In many places, completion functions need to call external commands to
generate the list of completions\&.  This style can be used to override the
command which is called in some such cases\&.  The elements of the value are
joined with spaces to form a command line to execute\&.  The value can also
start with a hyphen, in which case the usual command will be added to the
end; this is most useful for putting `\fBbuiltin\fP' or `\fBcommand\fP' in
front to make sure the appropriate version of a command is called, for
example to avoid calling a shell function with the same name as an external
command\&.
.RS
.PP
As an example, the function generating process IDs as matches uses this
style with the \fBprocesses\fP tag to generate the IDs to complete and
the list of processes to display (if the \fBverbose\fP style is `true')\&.
The list produced by the command should look like the output of the
\fBps\fP command\&.  The first line is not displayed, but is searched for
the string `\fBPID\fP' (or `\fBpid\fP') to find the position of the
process IDs in the following lines\&.  If the line does not contain
`\fBPID\fP', the first numbers in each of the other lines are taken as the 
process IDs to complete\&.
.PP
Note that the completion function generally has to call the command
every time it is called\&.  Because of that care should be taken to
specify only commands that take a short time to run (and that will
eventually stop at all)\&.
.RE
.TP
\fBcommands\fP
This is used by the function completing sub\-commands for the system
initialisation scripts (residing in \fB/etc/init\&.d\fP or somewhere not
too far away from that)\&.  It's values give the default commands to
complete for those commands for which the completion function isn't
able to find them out automatically\&.  The default for this style are
the two strings `\fBstart\fP' and `\fBstop\fP'\&.
.TP
\fBcomplete\fP
This is used by the \fB_expand_alias\fP function when invoked as a
bindable command\&.  If it set to `true' and the word on the command
line is not the name of an alias, matching alias names will be
completed\&.
.TP
\fBcompleter\fP
The strings given as the value of this style provide the names of the
completer functions to use\&. The available completer functions are
described in
the section `Control Functions' below\&.
.RS
.PP
Each string may be the name of a completer function or a string of the 
form `\fIfunction\fP\fB:\fP\fIname\fP'\&. In the first case the
\fIcompleter\fP field of the context will contain the name of the
completer without the leading underscore and with all other
underscores replaced by hyphens\&.  In the second case the
\fIfunction\fP is the name of the completer to call, but the context
will contain the \fIname\fP in the \fIcompleter\fP field of the
context\&.  If the \fIname\fP starts with a hyphen, the string for the
context will be build from the name of the completer function as in
the first case with the \fIname\fP appended to it\&.  For example: 
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete _complete:\-foo\fP
.fi
.RE
.PP
Here, completion will call the \fB_complete\fP completer twice, once
using `\fBcomplete\fP' and once using `\fBcomplete\-foo\fP' in the
\fIcompleter\fP field of the context\&.  Normally, using the same
completer more than once makes only sense when used with the
`\fIfunctions\fP\fB:\fP\fIname\fP' form, because otherwise the context
name will be the same in all calls to the completer; possible
exceptions to this rule are the \fB_ignored\fP and \fB_prefix\fP
completers\&.
.PP
The default value for this style is \fB_complete _ignored\fP,
i\&.e\&. normally only completion will be done, first using the
\fBignored\-patterns\fP style and the \fB$fignore\fP array and then without 
ignoring matches\&.
.RE
.TP
\fBcondition\fP
This style is used by the \fB_list\fP completer function to decide if
insertion of matches should be delayed unconditionally\&. The default is 
`true'\&.
.TP
\fBdisabled\fP
If this is set to `true', the \fB_expand_alias\fP completer and bindable 
command will try to expand disabled aliases, too\&.  The default is
`\fBfalse\fP'\&.
.TP
\fBdisable\-stat\fP
This is used with an empty tag by the function completing for the
\fBcvs\fP command to decide if the \fBzsh/stat\fP module should be used to
generate names of modified files in the appropriate places (this is its
only use)\&.  If set, completion will use the \fBls\fP command\&.
.TP
\fBdomains\fP
If set, gives the names of network domains that should be
completed\&.  If this is not set by the user domain names will be taken from
the file \fB/etc/resolv\&.conf\fP\&.
.TP
\fBexpand\fP
This style is used when completing strings consisting of multiple
parts, such as path names\&.  If one of its values is
the string `\fBprefix\fP', the partially typed word from
the line will be expanded as far as possible even if trailing parts
cannot be completed\&.  If one of its values is the string `\fBsuffix\fP',
matching names for
components after the first ambiguous one will also be added\&.  This
means that the resulting string is the longest unambiguous string
possible, but if menu completion is started on the list of matches
generated this way,
this will also cycle through the names of the files in pathname
components after the first ambiguous one\&.
.TP
\fBfake\-files\fP
This style is used when completing files and looked up 
without a tag\&.  Its values are of the form
`\fIdir\fP\fB:\fP\fInames\&.\&.\&.\fP'\&.  This will add the \fInames\fP (strings
separated by spaces) as
possible matches when completing in the directory \fIdir\fP, even if no 
such files really exist\&.
.RS
.PP
This can be useful on systems that support special filesystems whose
top\-level pathnames can not be listed or generated with glob patterns\&.
It can also be used for directories for which one does not have read
permission\&.
.RE
.TP
\fBfake\-parameters\fP
This is used by the completion function generating parameter names as
matches\&.  Its values are names of parameters which might not yet be
set, but which should be completed nonetheless\&.  Each name may also be 
followed by a colon and a string specifying the type of the parameter
(like `\fBscalar\fP', `\fBarray\fP' or `\fBinteger\fP')\&.  If such a type is
given, the name will only be completed if parameters of that type are
requested in the particular context\&.  Names for which no type is
specified will always be completed\&.
.TP
\fBfile\-patterns\fP
In most places where filenames are completed, the function \fB_files\fP
is used which can be configured with this style\&.  If the style is
unset, \fB_files\fP offers, one after another, up to three tags:
`\fBglobbed\-files\fP',
`\fBdirectories\fP' and `\fBall\-files\fP', depending on the types of files
expected by the caller of \fB_files\fP\&.
.RS
.PP
If the \fBfile\-patterns\fP style is set, the default tags are not
used\&.  Instead, the value of the style says which tags and which
patterns are to be offered\&.  The strings in the value contain
specifications of the form
`\fIpattern\fP\fB:\fP\fItag\fP'; each string may contain any number of
such specifications\&.  The \fIpattern\fP gives a glob 
pattern that is to be used to generate
filenames\&.  If it contains the sequence `\fB%p\fP', that is replaced by
the pattern(s) given by the calling function\&.
Colons in the pattern must be preceded by a backslash to
make them distinguishable from the colon before the \fItag\fP\&.  If more
than one pattern is needed, the patterns can be given inside braces,
separated by commas\&.  The
\fItag\fPs of all strings in the value will be offered by \fB_files\fP
(again, one after another) and used when looking up other styles\&.  For
strings containing more than one specification, the filenames for all
specifications will be generated at the same try\&.  If
no `\fB:\fP\fItag\fP' is given the `\fBfiles\fP' tag will be used\&.  The
\fItag\fP may also be
followed by an optional second colon and a description\&.  If that is
given, this description will be used for the `\fB%d\fP' in the value of
the \fBformat\fP style (if that is set) instead of the default
description supplied by the completion function\&.  If the description
given here contains itself a `\fB%d\fP', that is replaced with the
description supplied by the completion function\&.
.PP
For example, to make the \fBrm\fP command first complete only names of
object files and the names of all files if no object file matches
the string on the line, one would do:
.PP
.RS
.nf
\fBzstyle ':completion:*:*:rm:*' file\-patterns \e 
    '*\&.o:object\-files' '%p:all\-files'\fP
.fi
.RE
.PP
Another interesting example is to change the default behaviour that
makes completion first offer files matching the patterns given by the
calling function, then directories and then all files\&.  Many people 
prefer to get both the files matching the given patterns and the
directories in the first try and all files at the second try\&.  To
achieve this, one could do:
.PP
.RS
.nf
\fBzstyle ':completion:*' file\-patterns \e 
    '%p:globbed\-files *(\-/):directories' '*:all\-files'\fP
.fi
.RE
.PP
This works even for contexts in which all files would be completed,
because \fB_files\fP will not try a pattern more than once and it stops
when the pattern `\fB*\fP' was tried\&.
.PP
Note also that during the execution of completion functions, the
\fBEXTENDED_GLOB\fP option is in effect, so the characters `\fB#\fP',
`\fB~\fP' and `\fB^\fP' have special meanings in the patterns\&.
.RE
.TP
\fBfile\-sort\fP
The completion function that generates filenames as possible matches
uses this style without a tag to determine in which order the 
names should be listed and completed when using menu completion\&.  The
value may be one of `\fBsize\fP' to sort them by the size of the file,
`\fBlinks\fP' to sort them by the number of links to the file,
`\fBmodification\fP' (or `\fBtime\fP' or `\fBdate\fP') to sort them by the last
modification time, `\fBaccess\fP' to sort them by the last access time, or
`\fBinode\fP' (or `\fBchange\fP') to sort them by the last inode change
time\&.  If the style is set to any other value, or is unset, files will be
sorted alphabetically by name\&.  If the value contains the string
`\fBreverse\fP', sorting is done in decreasing order\&.
.TP
\fBforce\-list\fP
This forces a list of completions to be shown at any point where listing is
done, even in cases where the list would usually be suppressed\&.
For example, normally the list is only shown if
there are at least two different matches\&.  By setting this style to
`\fBalways\fP', the list will always be shown, even if there is only a
single match which is immediately accepted\&.  The style may also
be set to a number\&.  In this case the list will be shown if there are
at least that many matches, even if they would all insert the same
string\&.
.RS
.PP
This style is tested for the default tag and all tags used when
generating matches\&. This allows one to turn unconditional listing on
for certain types of matches\&.
.RE
.TP
\fBformat\fP
If this is set for the \fBdescriptions\fP tag, its value is used as a
string to display above matches in completion lists\&.  The sequence
`\fB%d\fP' in this string will be replaced with a short description of
what these matches are\&.  This string may also contain the sequences to
specify output attributes, such as `\fB%B\fP', `\fB%S\fP' and
`\fB%{\fP\&.\&.\&.\fB%}\fP'\&.
.RS
.PP
For the same purpose, this style is also tested with the tags used when
matches are generated before it is tested for the \fBdescriptions\fP
tag\&.  This provides the possibility of defining different format
strings for different types of matches\&.
.PP
Note also that some completer functions define additional
`\fB%\fP'\-sequences\&.  These are described for the completer functions that 
make use of them\&.
.PP
For the \fBmessages\fP tag, this style defines a string used by some
completion functions to display messages\&.  Here, the `\fB%d\fP' is
replaced with a message given by the completion function\&.
.PP
Finally, when set with the \fBwarnings\fP tag, the format string is
printed when no matches could be generated at all\&.  In this case the
`\fB%d\fP' is replaced with the descriptions for the matches that were
expected separated by spaces and the sequence `\fB%D\fP' is replaced with
those descriptions separated by newlines\&.
.PP
The `\fB%\fP' for the sequences that are replaced by strings provided by 
the completion functions like the `\fB%d\fP' may be followed by field
width specifications as  described for the \fBzformat\fP builtin command
from the \fBzsh/zutil\fP module, see
\fIzshmodules\fP(1)\&.
.RE
.TP
\fBglob\fP
This is used by the \fB_expand\fP completer\&.  If
it is set to `true' (the default), globbing will be attempted on the
words resulting from substitution (see the \fBsubstitute\fP style) or
the original string from the line\&.
.TP
\fBglobal\fP
If this is set to `true' (the default), the \fB_expand_alias\fP
completer and bindable command will try to expand global aliases\&.
.TP
\fBgroup\-name\fP
The completion system can put different types of matches in different
groups which are then displayed separately in the list of possible
completions\&.  This style can be used to give the names for these groups
for particular tags\&.  For example, in command position the completion
system generates names of builtin and external commands, names of
aliases, shell functions and parameters and reserved words as possible
completions\&.  To have the external commands and shell functions listed
separately, one can set:
.RS
.PP
.RS
.nf
\fBzstyle ':completion:*:*:\-command\-:*:commands' group\-name commands
zstyle ':completion:*:*:\-command\-:*:functions' group\-name functions\fP
.fi
.RE
.PP
This also means that if the same name is used for different types of
matches, then those matches will be displayed together in the same
group\&.
.PP
If the name given is the empty string, then the name of the tag for
the matches will be used as the name of the group\&. So, to have all
different types of matches displayed separately, one can just set:
.PP
.RS
.nf
\fBzstyle ':completion:*' group\-name ''\fP
.fi
.RE
.PP
All matches for which no group name is defined will be put in a group
named \fB\-default\-\fP\&.
.RE
.TP
\fBgroup\-order\fP
This style is to be used together with the \fBgroup\-name\fP style\&.  Once
different types of matches are put into different groups, this style
can be used to define in which order these groups should appear when listing 
(compare \fBtag\-order\fP, which determines which completions appear at
all)\&.  The strings in the value are taken as group names and the named
groups will be shown in the order in which their names appear in the
value\&.  All groups whose names are not given in the value of this style 
will appear in the order defined by the function generating the
matches\&.
.RS
.PP
For example, to have names of builtin commands, shell functions and
external commands appear in this order when completing in command
position one would set:
.PP
.RS
.nf
\fBzstyle ':completion:*:*:\-command\-:*' group\-order \e 
       builtins functions commands\fP
.fi
.RE
.RE
.TP
\fBgroups\fP
A style holding the names of the groups that should be completed\&. If
this is not set by the user, the group names from the YP database or
the file `\fB/etc/group\fP' will be used\&.
.TP
\fBhidden\fP
If this is set to one of the `true' values, the matches for the tags
for which this is set will not appear in the list; only the
description for the matches as set with the \fBformat\fP style will be
shown\&.  If this is set to `\fBall\fP', not even the description will be
displayed\&.
.RS
.PP
Note that the matches will still be completed; they are just not shown 
in the list\&.  To avoid having matches considered as possible
completions at all, the \fBtag\-order\fP style can be modified as described
below\&.
.RE
.TP
\fBhosts\fP
A style holding the names of hosts that should be completed\&. If this
is not set by the user the hostnames in `\fB/etc/hosts\fP' will be used\&.
.TP
\fBhosts\-ports\fP
This style is used by commands that need or accept hostnames and
ports\&.  The strings in the value should be of the form
`\fIhost\fP\fB:\fP\fIport\fP'\&.  These hostnames and ports are completed
depending on the information already on the line, so that if, for
example, the hostname is already typed, only those ports specified for that
host will be completed\&.  Multiple ports for the same host may appear\&.
.TP
\fBignore\-line\fP
This style is tested for the tags used when generating matches\&.  If it
is set to `true', then none of the words that are already on the line
will be considered possible completions\&.  If it is set to
`\fBcurrent\fP', the word the cursor is on will not be considered a
possible completion\&.  The same happens if the value is
`\fBcurrent\-shown\fP', but only if the list of completions is currently
shown on the screen\&.  Finally, if it is set to `\fBother\fP' all words
except the current one will not be considered to be a possible
completion\&.
.RS
.PP
The values `\fBcurrent\fP' and `\fBcurrent\-shown\fP' are a bit like the
opposite of \fBaccept\-exact\fP\&. They mean that only strings with
missing characters will be completed\&.
.PP
Note that you almost certainly don't want to set this to `true' or
`\fBother\fP' for a general
context such as `\fB:completion:*\fP'\&.  This is because it would disallow
completion of, for example, options multiple times even if the command
in question accepts the option more than once\&.
.RE
.TP
\fBignore\-parents\fP
The style is tested by the function completing pathnames without a tag to
determine whether to ignore
the names of directories already mentioned in the current word, or the
name of the current working directory\&.  The value must include one or both
of the following strings:
.RS
.PP
.PD 0
.TP
.PD
\fBparent\fP
The name of any directory whose path is already contained in the word on
the line is ignored\&.  For example, when completing after \fBfoo/\&.\&./\fP, the
directory \fBfoo\fP will not be considered a valid completion\&.
.TP
\fBpwd\fP
The name of the current working directory will not be completed, so that,
for example, completion after \fB\&.\&./\fP will not use the name of the current
directory\&.
.PP
In addition, the value may include one or both of:
.PP
.PD 0
.TP
.PD
\fB\&.\&.\fP
Ignore the specified directories only when the word on the line contains
the substring `\fB\&.\&./\fP'\&.
.TP
\fBdirectory\fP
Ignore only when names of directories are completed, not when completing
names of files\&.
.PP
Note that names of directories ignored because of one of the tests
will be ignored in the same way as the matches ignored because of the
\fBignored\-patterns\fP style\&.  I\&.e\&., by using the \fB_ignored\fP completer
it is possible to complete these directories nonetheless\&.
.RE
.TP
\fBignored\-patterns\fP
This style can be used to specify a list of patterns which are tested
against against the trial completions in a given context; any matching
completions will be removed from the list of possibilities\&.  The
\fB_ignored\fP completer can appear in the list of completers to produce a
list which includes these matches once more\&.  This is a more configurable
version of the shell parameter \fB$fignore\fP\&.
.RS
.PP
Note that during the execution of completion functions, the
\fBEXTENDED_GLOB\fP option is in effect, so the characters `\fB#\fP',
`\fB~\fP' and `\fB^\fP' have special meanings in the patterns\&.
.RE
.TP
\fBinsert\-ids\fP
When completing process IDs, for example as arguments to the \fBkill\fP and
\fBwait\fP builtins, completion allows the user to type the name of a
command, which will be converted to the appropriate process ID\&.  A problem
arises when the process name typed is not unique\&.  By default (or if this
style is set explicitly to `\fBmenu\fP') the name will be converted
immediately to a set of possible IDs, and menu completion will be started
to cycle through them\&.  If the value of the style is `\fBsingle\fP', however,
the shell will wait until the user has typed enough to make the command
unique before converting the name to an ID; the user must type any
additional characters required\&.  If the value is any other string, menu
completion will be started when the string typed by the user is longer than
the common prefix of the corresponding IDs\&.
.TP
\fBinsert\-tab\fP
If this has one of the `true' values, the completion system will
insert a TAB character (assuming it was used to start completion) instead
of performing completion when there is no non\-blank character to the left
of the cursor\&.  If set to `false', completion will be done even there\&.
.RS
.PP
The value may also contain the substrings `\fBpending\fP' or
`\fBpending=\fP\fIval\fP' to make the character typed to start completion 
be inserted instead of completion being tried when there is input
pending which has not yet been processed by the shell\&. If a \fIval\fP
is given, completion will not be done if there are at least that many
characters of unprocessed input\&. This is often useful to have set when 
pasting characters into a terminal\&. Note however, that it relies on
the \fB$PENDING\fP special parameter from the \fBzsh/zle\fP module being set
properly which is not guaranteed on all platforms\&.
.PP
The default value of this style is `true' unless when completing
inside the \fBvared\fP builtin command, where it defaults to `false'\&.
.RE
.TP
\fBinsert\-unambiguous\fP
This is used by the \fB_match\fP and \fB_approximate\fP completer
functions, where the possible completions may not have a common prefix so
that menu completion is often the most useful may of choosing completions\&.
If the style is set to `true', the completer will start menu
completion only if no unambiguous string could be generated that is at
least as long as the original string typed by the user\&.  Note that the
\fB_approximate\fP completer uses it after setting the completer field
in the context name to one of \fBcorrect\-\fP\fInum\fP or
\fBapproximate\-\fP\fInum\fP, where \fInum\fP is the number of errors that
were accepted\&.
.RS
.PP
When used for the \fB_match\fP completer, the style may also be set to
the string `\fBpattern\fP'\&.  This makes the pattern on the line be left
unchanged if it didn't match unambiguously\&.
.RE
.TP
\fBkeep\-prefix\fP
This style is used by the \fB_expand\fP completer\&.  If it is `true', the
completer will try to keep a prefix containing a tilde or parameter
expansion\&.  I\&.e\&., the string `\fB~/f*\fP' would be expanded to
`\fB~/foo\fP' instead of `\fB/home/user/foo\fP'\&.  If the style is set to
`\fBchanged\fP' (the default), the prefix will only be left unchanged if
there were other changes between the expanded words and the original
word from the command line\&.  Any other value makes the prefix be
expanded unconditionally\&.
.RS
.PP
Note that with one of the `true' values, the \fB_expand\fP completer
returns if there is only one expansion and that is, after restoring
the original prefix, the same as the original word\&.  This means that
other completers will be called immediately after \fB_expand\fP\&.
.RE
.TP
\fBlast\-prompt\fP
This is used to determine if the completion code should try to put the
cursor back onto the previous command line after showing a completion
listing (as for the \fBALWAYS_LAST_PROMPT\fP option)\&.  As with several other
styles, it is tested for the \fBdefault\fP tag as well as all the possible
tags when generating matches\&.  The cursor will be moved back to the
previous line if this style is `true' for all types of matches added\&.  Note
also that this is independent of the numeric argument, unlike the
\fBALWAYS_LAST_PROMPT\fP option\&.
.TP
\fBlist\fP
This style is used by the \fB_history_complete_word\fP bindable command\&.
If it is set to `true' it has no effect, but if it is set to `false'
the matches will not be listed, overriding the setting of the options
that control listing behaviour, especially \fBAUTO_LIST\fP\&. Use the
context prefix `\fB:completion:history\-words\fP'\&.
.TP
\fBlist\-colors\fP
If the \fBzsh/complist\fP module is used, this style can be used to set
color specifications as with the \fBZLS_COLORS\fP and \fBZLS_COLOURS\fP
parameters, which will not be honored under this completion system (see
the section `The zsh/complist Module' in \fIzshmodules\fP(1))\&.
.RS
.PP
If this style is set for the \fBdefault\fP tag, the strings in the value 
are taken as specifications that are to be used everywhere\&.  If it is
set for other tags, the specifications are used only for matches of
the type described by the tag\&.  For this to work best, the \fBgroup\-name\fP
style must be set to an empty string\&.  If the \fBgroup\-name\fP tag
specifies other names for the groups the matches in these groups can
be colored by using these names together with the `\fB(group)\&.\&.\&.\fP'
syntax described for the \fBZLS_COLORS\fP and \fBZLS_COLOURS\fP parameters 
and adding the specifications to the value for this style with the
\fBdefault\fP tag (although in most cases it should work by setting this 
style for the appropriate tags)\&.
.PP
It is possible to use the same specifications set up for the GNU
version of the \fBls\fP command:
.PP
.RS
.nf
\fBzstyle ':completion:*:default' list\-colors ${(s\&.:\&.)LS_COLORS}\fP
.fi
.RE
.PP
The default colors are the same as for the GNU \fBls\fP command and can be
obtained by setting the style to an empty string (i\&.e\&. \fB''\fP)\&.
.RE
.TP
\fBlist\-packed\fP
Like the \fBlist\-colors\fP style, this is tested with the \fBdefault\fP
tag and all tags used when generating matches\&.  If it is set to `true'
for a tag, the matches added for it will be listed as if the
\fBLIST_PACKED\fP option were set\&.  If it is set to `false',
they are listed normally\&.
.TP
\fBlist\-prompt\fP
If this style is set for the \fBdefault\fP tag,
completion lists that don't fit on the screen can be scrolled (see
the description of the \fBzsh/complist\fP module in \fIzshmodules\fP(1))\&.  The value, if not the empty string, will be displayed after every
screenful and the shell will prompt for a key press; if the style is
set to the empty string,
a default prompt will be used\&.  The value may contain the escape sequences
`\fB%l\fP' or `\fB%L\fP', which will be replaced by the number of the last line
displayed and the total number of lines; `\fB%m\fP' or `\fB%M\fP', which will
be replaced by the number of the  last match shown and the total number of
matches; and `\fB%p\fP' and `\fB%P\fP', which will be replaced by `\fBTop\fP'
when at the beginning of the list, `\fBBottom\fP' when at the end and the
position shown in percent of the total length otherwise\&.  In each of these
cases the form with the uppercase letter is replaced by a string of fixed
width, padded to the  right with spaces\&.  As in other prompt strings, the
escape sequences `\fB%S\fP', `\fB%s\fP', `\fB%B\fP', `\fB%b\fP', `\fB%U\fP',
`\fB%u\fP', and `\fB%{\fP\&.\&.\&.\fB%}\fP' for entering and leaving the display modes
standout, bold and underline are also available\&.
.TP
\fBlist\-rows\-first\fP
This style is tested in the same way as the \fBlist\-packed\fP style and
determines if matches are to be listed in a rows\-first fashion, as for the
\fBLIST_ROWS_FIRST\fP option\&.
.TP
\fBlist\-suffixes\fP
This style is used by the function used to complete filenames\&.  If
completion is attempted on a string containing multiple partially
typed pathname components and this style is set to `true', all
components starting with the first one for which more than one match
could be generated will be shown\&.
.TP
\fBlocal\fP
This style is used by completion functions which generate URLs as
possible matches to add suitable matches when a URL points to a
local web server, that is, one whose files are available directly on the
local file system\&.  Its value should consist of three strings: a
hostname, the path to the default web pages for the server and the
directory name used by a user placing web pages within their home
area\&.  For example, completion after `\fBhttp://toast/~yousir/\fP' will
attempt to match the name `\fBtoast\fP' against the first argument to the
style, and if successful will look in the directory under \fB~yousir\fP given
by the third argument to the style for possible completions\&.
.TP
\fBmatch\-original\fP
This is used by the \fB_match\fP completer\&.  If it is set to
\fBonly\fP, \fB_match\fP will try to generate matches without inserting a
`\fB*\fP' at the cursor position\&.  If set to any other non\-empty value,
it will first try to generate matches without inserting the `\fB*\fP'
and if that yields no matches, it will try again with the `\fB*\fP'
inserted\&.  If it is unset or set to the empty string, matching will
only be done with the `\fB*\fP' inserted\&.
.TP
\fBmatcher\fP
This style is tested for tags used when generating matches\&.  Its value
is used as an match specification additional to any given by the
\fBmatcher\-list\fP style which should be in the form described in
the section `Matching Control' in \fIzshcompwid\fP(1)\&.
.TP
\fBmatcher\-list\fP
This style is used by the main completion function to retrieve match
specifications that are to be used everywhere\&.  Its value should be a
list of such specifications\&.  The completion system will try them one
after another for each completer selected\&. For example, to first try
simple completion and, if that generates no matches, case\-insensitive
completion one would do:
.RS
.PP
.RS
.nf
\fBzstyle ':completion:*' matcher\-list '' 'm:{a\-zA\-Z}={A\-Za\-z}'\fP
.fi
.RE
.PP
By default every specification replaces previous ones\&. If specification
is prefixed with \fB+\fP, it is added to the existing list\&. This allows
testing more general patterns without repeating the whole list every
time, as in:
.PP
.RS
.nf
\fBzstyle ':completion:*' matcher\-list '' '+m{a\-Z}={A\-Z}' '+m{A\-Z}={a\-z}'\fP
.fi
.RE
.PP
The style allows even finer control by specifying a particular completer,
without the leading underscore, in the third field of the completion
context\&.  For example, if one uses the completers \fB_complete\fP and
\fB_prefix\fP but wants to try case\-insensitive completion only when using
the \fB_complete\fP completer, one would do:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete _prefix
zstyle ':completion:*:complete:*' matcher\-list \e 
       '' 'm:{a\-zA\-Z}={A\-Za\-z}'\fP
.fi
.RE
.PP
Note that the \fBcompleter\fP style allows user\-defined names to 
be used in the context instead of the name of the completer\&.
This is useful if, for example, one wants to try
normal completion without a match specification and with
case\-insensitive matching first, correction if that doesn't generate
any matches and partial\-word completion if that doesn't yield any
matches either\&.  In this case one can give the \fB_complete\fP
completer more than once in the \fBcompleter\fP style and define different
match specifications for each occurrence, as in:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete _correct _complete:foo
zstyle ':completion:*:complete:*' matcher\-list \e 
    '' 'm:{a\-zA\-Z}={A\-Za\-z}'
zstyle ':completion:*:foo:*' matcher\-list \e 
    'm:{a\-zA\-Z}={A\-Za\-z} r:|[\-_\&./]=* r:|=*'\fP
.fi
.RE
.PP
If the style is unset in any context no match specification is applied;
further, some completers such as \fB_correct\fP and \fB_approximate\fP do not
use the match specifications at all\&.  However, it is always safe
to use the simple form for this style (as in the first example above),
since any completers which do not use match specifications will only ever
be called once, rather than once per specification\&.
.PP
Since the specification\-strings in this style have to be tried one after
another, it is a good idea to keep their number low\&.  In most cases
one to three strings (each of which may, without to large a performance 
hit, consist of more than one single match specification) will give
acceptable performance\&.
.RE
.TP
\fBmax\-errors\fP
This is used by the \fB_approximate\fP and \fB_correct\fP completer functions
to determine the maximum number of errors to allow\&.  The completer will try
to generate completions by first allowing one error, then two errors, and
so on, until either a match or matches were found or the maximum number of
errors given by this style has been reached\&.
.RS
.PP
If the value for this style contains the string `\fBnumeric\fP', the 
completer function will take any numeric argument as the
maximum number of errors allowed\&. For example, with
.PP
.RS
.nf
\fBzstyle ':completion:*:approximate:::' max\-errors 2 numeric\fP
.fi
.RE
.PP
two errors are allowed if no numeric argument is given, but with
a numeric argument of six (as in `\fBESC\-6 TAB\fP'), up to six
errors are accepted\&.  Hence with a value of `\fB0 numeric\fP', no correcting
completion will be attempted unless a numeric argument is given\&.
.PP
If the value contains the string `\fBnot\-numeric\fP', the completer
will \fInot\fP try to generate corrected
completions when given a numeric argument, so in this case the number given
should be greater than zero\&.  For example, `\fB2 not\-numeric\fP' specifies that
correcting completion with two errors will usually be performed, but if a
numeric argument is given, correcting completion will not be
performed\&.
.PP
The default value for this style is `\fB2 numeric\fP'\&.
.RE
.TP
\fBmenu\fP
If this is set to true in a given context, using any of the tags defined
for a given completion, menu completion will be used\&.  The tag
`\fBdefault\fP' can be used to set the default value, but a specific tag will take
precedence\&.  If none of the values found in this way is true but at least
one is set to `\fBauto\fP' the behaviour will be as for the \fBAUTO_MENU\fP
option\&.  Finally, if one of the values is explicitly set to false, menu
completion will be turned off even if it would otherwise be active (for
example, with the \fBMENU_COMPLETE\fP option)\&.
.RS
.PP
Using the form `\fByes=\fP\fInum\fP', where `\fByes\fP' may be any of the
true values (`\fByes\fP', `\fBtrue\fP', `\fBon\fP' and `\fB1\fP') turns on
menu completion if there at least \fInum\fP matches\&.  Using this for one
of the `false' values (as in `\fBno=10\fP') makes menu completion
\fInot\fP be used if there are \fInum\fP or more matches\&.  Of course,
this is only useful when menu completion is normally used, e\&.g\&. by
setting the \fBMENU_COMPLETE\fP option\&.  The `true' values may also be
used in the form `\fByes=long\fP' to turn on menu completion
if the list does not fit onto the screen\&.  This will start menu
completion only if normal completion was attempted, not when only the
list of possible completions was requested\&.  To start menu completion
even then, the value `\fByes=long\-list\fP' can be used\&.
.PP
In addition to (or instead of) the above possibilities, the value may
contain the string `\fBselect\fP', optionally followed by an equals sign and a
number\&.  In this case menu selection (as defined by the \fBzsh/complist\fP
module) will be started\&.  Without the optional number, it will be started
unconditionally and with a number it will be started only if at least that
many matches are generated; if the values for more than one tag provide a
number, the smallest number is taken\&.  Menu selection can be turned off
explicitly by defining a value containing the string `\fBno\-select\fP'\&.
.PP
It is also possible to start menu selection only if the list of
matches does not fit on the screen by using the value
`\fBselect=long\fP'\&.  This will only start menu selection if the widget
invoked does completion, not simply listing as done by
\fBdelete\-char\-or\-list\fP; to start menu selection even here, use the value
`\fBselect=long\-list\fP'\&.
.PP
To turn on menu completion or menu selection when a certain number of
matches is generated \fIor\fP the list of matches does not fit onto the
screen, both of `\fByes=\fP' and `\fBselect=\fP' can be given twice, once
with a number and once with `\fBlong\fP' or `\fBlong\-list\fP'\&.
.RE
.TP
\fBnumbers\fP
This is used with the \fBjobs\fP tag\&.  If it is `true', the shell will
complete the job numbers instead of the shortest unambiguous strings
of the jobs' command lines\&.  If the value is a number, job numbers will
only be used if that many words from the job descriptions are required to
resolve ambiguities\&.  For example, if the value is `\fB1\fP', strings will
only be used if all jobs differ in the first word on their command lines\&.
.TP
\fBold\-list\fP
This is used by the \fB_oldlist\fP completer\&.  If it is set to `\fBalways\fP',
then standard widgets which perform listing will retain the current list of
matches, however they were generated; this can be turned off explicitly
with the value `\fBnever\fP', giving the behaviour without the \fB_oldlist\fP
completer\&.  If the style is unset, or any other value, then the existing
list of completions is displayed if it is not already; otherwise, the
standard completion list is generated; this is the default behaviour of
\fB_oldlist\fP\&.  However, if there is an old list and this style contains
the name of the completer function that generated the list, then the
old list will be used even if it was generated by a widget which does
not do listing\&.
.RS
.PP
For example, suppose you type \fB^Xc\fP to use the \fB_correct_word\fP
widget, which generates a list of corrections for the word under the
cursor\&.  Usually, typing \fB^D\fP would generate a standard list of
completions for the word on the command line, and show that\&.  With
\fB_oldlist\fP, it will instead show the list of corrections already
generated\&.
.PP
As another example consider the \fB_match\fP completer: with the
\fBinsert\-unambiguous\fP style set to `true' it inserts only a common prefix
string, if there is any\&.  However, this may remove parts of the original
pattern, so that further completion could produce more matches than on the
first attempt\&.  By using the \fB_oldlist\fP completer and setting this style
to \fB_match\fP, the list of matches generated on the first attempt will be
used again\&.
.RE
.TP
\fBold\-matches\fP
This is used by the \fB_all_matches\fP completer to decide if an old
list of matches should be used if one exists\&.  It may be set to one of 
the `true' values or to the string `\fBonly\fP' to use such a list\&.  If
it is set to `\fBonly\fP', \fB_all_matches\fP will only use an old list
and won't have any effect on the list of matches currently being
generated\&.
.TP
\fBold\-menu\fP
This is used by the \fB_oldlist\fP completer\&.  It controls how menu
completion behaves when a completion has already been inserted and the
user types a standard completion key type such as \fBTAB\fP\&.  The default
behaviour of \fB_oldlist\fP is that menu completion always continues
with the existing list of completions\&.  If this style is set to
`false', however, a new completion is started if the old list was
generated by a different completion command; this is the behaviour without
the  \fB_oldlist\fP completer\&.
.RS
.PP
For example, suppose you type \fB^Xc\fP to generate a list of corrections,
and menu completion is started in one of the usual ways\&.  Usually, or with
this style set to \fBfalse\fP, typing \fBTAB\fP at this point would start
trying to complete the line as it now appears\&.  With \fB_oldlist\fP, it
instead continues to cycle through the list of corrections\&.
.RE
.TP
\fBoriginal\fP
This is used by the \fB_approximate\fP and \fB_correct\fP
completers to decide if the original string should be added as
one possible completion\&.  Normally, this is done only if there are
at least two possible corrections, but if this style is set to `true', it
is always added\&.  Note that these completers use this style after
setting the completer field in the context name to
\fBcorrect\-\fP\fInum\fP or \fBapproximate\-\fP\fInum\fP, where \fInum\fP is
the number of errors that were accepted\&.
.TP
\fBpackageset\fP
This style is used when completing arguments of the Debian `\fBdpkg\fP'
program\&.  It contains an override for the default package set
for a given context\&.  For example,
.RS
.PP
.RS
.nf
\fBzstyle ':completion:*:complete:dpkg:option\-\-status\-1:*' \e 
               packageset avail\fP
.fi
.RE
.PP
causes available packages, rather than only installed packages,
to be completed for `dpkg \-\-status'\&.
.RE
.TP
\fBpath\fP
The function that completes color names uses this style with the 
\fBcolors\fP tag\&.  The value should be the pathname of a file
containing color names in the format of an X11 \fBrgb\&.txt\fP file\&.  If
the style is not set but this file is found in one of various standard
locations it will be used as the default\&.
.TP
\fBports\fP
A style holding the service names of ports to complete\&.  If this is
not set by the user, the service names from `\fB/etc/services\fP' will
be used\&.
.TP
\fBprefix\-hidden\fP
This is used when matches with a common prefix are added (e\&.g\&. option
names)\&.  If it is `true', this prefix will not be shown in the list of
matches\&.
.RS
.PP
The default value for this style is `false'\&.
.RE
.TP
\fBprefix\-needed\fP
This, too, is used for matches with a common prefix\&.  If it is set to
`true' this common prefix has to be typed by the user to generate the
matches\&.  E\&.g\&. for options this means that the `\fB\-\fP', `\fB+\fP', or
`\fB\-\fP\fB\-\fP' has to be on the line to make option names be completed at
all\&.
.RS
.PP
The default value for this style is `true'\&.
.RE
.TP
\fBpreserve\-prefix\fP
This style is used when completing path names\&.  Its value should be a
pattern matching an initial prefix of the word to complete that should
be left unchanged under all circumstances\&.  For example, on some Unices
an initial `\fB//\fP' (double slash) has a special meaning and hence
should be kept\&.  For that one could set this style to the string
`\fB//\fP'\&.  As another example, setting this style to `\fB?:/\fP' under
Cygwin would allow completion after `\fBa:/\&.\&.\&.\fP' and the like\&.
.TP
\fBrange\fP
This is used by the \fB_history\fP completer and the
\fB_history_complete_word\fP bindable command to decide which words
should be completed\&.  It may be set to a number, \fIN\fP, to say that
only the last \fIN\fP words from the history should be completed\&.  The
value may also be of the form `\fImax\fP\fB:\fP\fIslice\fP'\&.  This means
that first the last \fIslice\fP words will be completed\&.  If that
yields no matches, the \fIslice\fP words before those will be tried and 
so on, until either at least one match is generated or \fImax\fP words
have been tried\&.  The default is to complete all words from the
history at once\&.
.TP
\fBregular\fP
This style is used by the \fB_expand_alias\fP completer and bindable 
command\&.  If set to `true' (the default), regular aliases will be
expanded but only in command position\&.  If it is set to `false', regular
aliases will never be expanded and if it is set to the string
`\fBalways\fP', regular aliases will be expanded even if not in command
position\&.
.TP
\fBremove\-all\-dups\fP
The \fB_history_complete_word\fP bindable command and the \fB_history\fP
completer use this to decide if all duplicate matches should be
removed, rather than just consecutive duplicates\&.
.TP
\fBselect\-prompt\fP
If this is set for the \fBdefault\fP tag, its
value will be displayed during menu selection (see the \fBmenu\fP style
above) when the completion list does not fit on the screen as a
whole\&.  The same escapes as for the \fBlist\-prompt\fP style are
understood, but give the number of the match or line the mark is
on\&.  A default prompt is used when the value is the empty string\&.
.TP
\fBselect\-scroll\fP
This style is tested for the \fBdefault\fP tag and determines how a
completion list is scrolled during a menu selection (see the \fBmenu\fP
style above) when the completion list does not fit on the screen as a
whole\&.  Its value should be `\fB0\fP' (zero) to scroll by
half\-screenfuls, a positive integer to scroll by that many lines and a
negative number to scroll by the number of lines of the screen minus
that number (or plus the number, since it is negative)\&.  The default is to
scroll by single lines\&.
.TP
\fBseparate\-sections\fP
This style is used with the \fBmanuals\fP tag when completing names of
manual pages\&.  If it is `true', entries for different sections are
added separately using tag names of the form `\fBmanual\&.\fP\fIX\fP',
where \fIX\fP is the section number\&.  This means that it is possible to
make pages from different sections be listed separately by setting the
\fBgroup\-name\fP style\&.  The default for this style is `false'\&.
.TP
\fBsingle\-ignored\fP
This is used by the \fB_ignored\fP completer\&.  It specifies what
should be done if it can generate only one match, which is often a
special case\&.  If its value is `\fBshow\fP', the single match will be
displayed but not inserted\&.  If the value is `\fBmenu\fP', then the single
match and the original string are both added as matches and menu completion
is started so that one can easily select either of them\&.
.TP
\fBsort\fP
If set to `true', completion functions that generate words from the
history as possible matches sort these words alphabetically instead of
keeping them in the order in which they appear in the history (from
youngest to oldest)\&.
.RS
.PP
This is also used by the \fB_expand\fP completer\&.  Here, if it is set to
`true', the expansions generated will always be sorted\&.  If it is set
to `\fBmenu\fP', then the expansions are only sorted when they are offered 
as single strings (not in the string containing all possible
expansions)\&.
.RE
.TP
\fBspecial\-dirs\fP
Normally, the completion code will not produce the directory names
`\fB\&.\fP' and `\fB\&.\&.\fP' as possible completions\&.  If this style is set to
`true', it will add both `\fB\&.\fP' and `\fB\&.\&.\fP' as possible completions;
if it is set to `\fB\&.\&.\fP', only `\fB\&.\&.\fP' will be added\&.
.TP
\fBsqueeze\-slashes\fP
If set to `true', sequences of slashes (as in `\fBfoo//bar\fP') will be
treated as if they were only one slash when completing pathnames\&.  This
is the usual behaviour of UNIX paths\&.  However, by default the file
completion function behaves as if there were a `\fB*\fP' between
the slashes\&.
.TP
\fBstop\fP
If set to `true', the \fB_history_complete_word\fP bindable
command will stop once when reaching the beginning or end of the
history\&.  Invoking \fB_history_complete_word\fP will then wrap around to 
the opposite end of the history\&.  If this style is set to `false' (the 
default), \fB_history_complete_word\fP will loop immediately as in a
menu completion\&.
.TP
\fBsubst\-globs\-only\fP
This is used by the \fB_expand\fP completer\&.  If it is set to `true',
the expansion will only be used if it resulted from globbing; hence,
if expansions resulted from the use of the \fBsubstitute\fP style
described below, but these were not further changed by globbing, the
expansions will be rejected\&.
.RS
.PP
The default for this style is `false'\&.
.RE
.TP
\fBsubstitute\fP
This boolean style controls whether the \fB_expand\fP completer will
first try to expand all substitutions in the string (such as
`\fB$(\&.\&.\&.)\fP' and `\fB${\&.\&.\&.}\fP')\&.
.RS
.PP
The default is `true'\&.
.RE
.TP
\fBsuffix\fP
This is used by the \fB_expand\fP completer if the word starts with a
tilde or contains a parameter expansion\&. If it is set to `true', the word will
only be expanded if it doesn't have a suffix, i\&.e\&. if it is something
like `\fB~foo\fP' or `\fB$foo\fP', but not if it is `\fB~foo/\fP' or
`\fB$foo/bar\fP', unless that suffix itself contains characters eligible
for expansion\&.  The default for this style is `true'\&.
.TP
\fBtag\-order\fP
This provides a mechanism for sorting how the tags available in a
particular context will be used\&.
.RS
.PP
The values for the style are sets of space\-separated lists of tags\&.
The tags in each value will be tried at the same time; if no match is
found, the next value is used\&.  (See the \fBfile\-patterns\fP style for
an exception to this behavior\&.)
.PP
For example:
.PP
.RS
.nf
\fBzstyle ':completion:*:complete:\-command\-:*' tag\-order \e 
    'commands functions'\fP
.fi
.RE
.PP
specifies that completion in command position should offer only
completions for external commands and shell functions immediately\&.
.PP
In addition to tag names, each string in the value may take one of the
following forms:
.PP
.PD 0
.TP
.PD
\fB\-\fP
If any string in the value consists of only a hyphen,
then \fIonly\fP the tags specified by the other strings in the value are
generated\&.  Normally all tags not explicitly selected are tried last
if the specified tags fail to generate any matches\&.  This means 
that a value consisting only of a single hyphen turns off completion\&.
.TP
\fB!\fP \fItags\fP\&.\&.\&.
A string starting with an exclamation mark
specifies names of tags that are \fInot\fP to be used\&.  The effect is
the same as if all other possible tags for the context had been
listed\&.
.TP
\fItag\fP\fB:\fP\fIlabel\fP \&.\&.\&.
In strings not starting with an exclamation mark, it is also possible
to specify tag labels instead of only tags, where \fItag\fP is one of
the tags offered
by the completion function for the current context and \fIlabel\fP is a 
name\&.  For this, the completion function will generate matches in the
same way as for the \fItag\fP but it will use the \fIlabel\fP in place
of the tag in the context names used to look up styles\&.  If the
\fIlabel\fP starts with a hyphen, the \fItag\fP is prepended to the
\fIlabel\fP to form the name used for lookup\&.  This can be
used to make the completion system try a certain tag more than once,
supplying different style settings for each attempt, see below for an
example\&.
.RS
.PP
The \fIlabel\fP may optionally be followed by a second colon and a
description\&.  This description will then be used for the `\fB%d\fP' in
the value of the \fBformat\fP style instead of the default description
supplied by the completion function\&.  Spaces in the description have to 
be quoted by preceding them with a backslash and a `\fB%d\fP' appearing
in the description is replaced with the description given by the
completion function\&.
.RE
.RE
.PP
In each of the cases above, the tag may also be a pattern or more than 
one pattern inside braces and separated by commas\&.  In this
case all of the offered tags matching the pattern(s) will be used except 
for those that are given explicitly in the same string\&.  There are
probably two main uses of this\&.  One is the case where one wants to try
one of the tags more than once, setting other styles differently for
each try, but still wants to use all the other tags without having to
repeat them all\&.  For example, to make completion of function names in
command position ignore all the completion functions starting with an
underscore the first time completion is tried, one could do:
.PP
.RS
.nf
\fBzstyle ':completion:*:*:\-command\-:*' tag\-order \e 
    'functions:\-non\-comp *' functions
zstyle ':completion:*:functions\-non\-comp' ignored\-patterns '_*'\fP
.fi
.RE
.PP
Here, the completion system will first try all tags offered, but will
use the tag label \fBfunctions\-non\-comp\fP when looking up styles for
the function names completed\&.  For this, the \fBignored\-patterns\fP style 
is set to exclude functions starting with an underscore from the set
of possible matches\&.  If none of the generated matches match the string 
on the line, the completion system will use the second value of the
\fBtag\-order\fP style and complete functions names again, but this time
using the name \fBfunctions\fP to look up styles, so that the
\fBignored\-patterns\fP style is not used and all function names
are considered\&.
.PP
Of course, this can also be used to split the matches for one tag into 
different groups\&. For example:
.PP
.RS
.nf
\fBzstyle ':completion:*' tag\-order \e 
    'options:\-long:long\e options
     options:\-short:short\e options
     options:\-single\-letter:single\e letter\e options'
.PP
zstyle ':completion:*:options\-long' ignored\-patterns '[\-+](|\-|[^\-]*)'
zstyle ':completion:*:options\-short' ignored\-patterns '\-\-*' '[\-+]?'
zstyle ':completion:*:options\-single\-letter' ignored\-patterns '???*'\fP
.fi
.RE
.PP
With the \fBgroup\-names\fP style set, this makes options beginning with
`\fB\-\fP\fB\-\fP', options beginning with a single `\fB\-\fP' or `\fB+\fP' but
containing multiple characters, and single\-letter options be displayed
in separate groups with different descriptions\&.
.PP
The second interesting use of patterns is the case where one wants to
try multiple match specifications one after another\&.  The
\fBmatcher\-list\fP style offers something similar, but it is tested very
early in the completion system and hence can't be set for single
commands nor for more specific contexts\&.  Here is how to
try normal completion without any match specification and, if that
generates no matches, try again with case\-insensitive matching, restricting
the effect to arguments of the command \fBfoo\fP:
.RS
.nf
\fBzstyle ':completion:*:*:foo:*' tag\-order '*' '*:\-case'
zstyle ':completion:*\-case' matcher 'm:{a\-z}={A\-Z}'\fP
.fi
.RE
.PP
First, all the tags offered when completing after \fBfoo\fP are tried using
the normal tag name\&.  If that generates no matches, the second value of
\fBtag\-order\fP is used, which tries all tags again except that this time
each has \fB\-case\fP appended to its name for lookup of styles\&.  Hence this
time the value for the \fBmatcher\fP style from the second call to \fBzstyle\fP
in the example is used to make completion case\-insensitive\&.
.PP
Using the \fB\-e\fP option of the \fBzstyle\fP builtin command, it is
possible to specify conditions saying when certain tags are to be
used\&. For example:
.PP
.RS
.nf
\fBzstyle \-e '*:\-command\-:*' tag\-order '
    if [[ \-n $PREFIX ]]; then
      reply=( )
    else
      reply=( \- )
    fi'\fP
.fi
.RE
.PP
Makes completion in command position happen only if the string on 
the line is not empty\&.  This is tested using the \fBPREFIX\fP
parameter which is special in completion widgets; see
zshcompwid
for a description of these special parameters\&.
Setting \fBreply\fP to an empty array ensures that only the default
behaviour of trying all tags at once is used and setting it to an
array containing only a hyphen disables that default behaviour \-\- thus 
keeping all tags from being tried\&.
.PP
If no style has been defined for a context, the strings
`\fB(|*\-)argument\-* (|*\-)option\-* values\fP' and `\fBoptions\fP' plus all
tags offered by the completion function will be used to provide a
sensible default behavior that causes arguments (whether normal command
arguments or arguments of options) to be completed before option names for
most commands\&.
.RE
.TP
\fBurls\fP
This is used together with the the \fBurls\fP tag by completion
functions that generate URLs as possible matches\&.  If the value
consists of more than one string or if the only string does not name a 
file or directory, the strings are used as the URLs to complete\&.
.RS
.PP
If the value contains only one string and that is the name of a normal 
file, the URLs are taken from that file (where the URLs may be
separated by white space or newlines)\&.
.PP
Finally, if the only string in the value names a directory, that
should contain sub\-directories named after the
retrieval methods which occur as the first part of a URL, i\&.e\&.
`\fBhttp\fP', `\fBftp\fP', `\fBbookmark\fP', and so on\&.  These
sub\-directories should contain files and other sub\-directories whose
pathnames are possible completions after the initial `\fBhttp://\fP',
`\fBftp://\fP', etc\&. See the description in the file \fB_urls\fP in the
\fBUser\fP sub\-directory of the completion system for more information\&.
.RE
.TP
\fBuse\-cache\fP
If this is set, the completion caching layer is activated for any completions
which use it (via the \fB_store_cache\fP, \fB_retrieve_cache\fP, and
\fB_cache_invalid\fP functions)\&.  The directory containing the cache
files can be changed with the \fBcache\-path\fP style\&.
.TP
\fBuse\-compctl\fP
If this style is set to a string \fInot\fP equal to \fBfalse\fP, \fB0\fP,
\fBno\fP, and \fBoff\fP, the completion system may use any completion
specifications defined with the \fBcompctl\fP builtin command\&.  If the
style is unset, this is done only if the \fBzsh/compctl\fP module
is loaded\&.  The string may also contain the substring `\fBfirst\fP' to
make the definition for `\fBcompctl \-T\fP' be used, and the substring
`\fBdefault\fP' to make the one for `\fBcompctl \-D\fP' be used\&.
.RS
.PP
Note that this is only intended to smooth the transition from
\fBcompctl\fP to the new completion system and may disappear in the
future\&.
.PP
Note also that the definitions from \fBcompctl\fP will only be used if
there is no specific completion function for the command in question\&.  For
example, while completing arguments to the command \fBfoo\fP, if this was
handled by a command function \fB_foo\fP, \fBcompctl\fP would never be tried,
while if it was handled by \fB_default\fP, \fBcompctl\fP would be tried\&.
.RE
.TP
\fBusers\fP
This may be set to a list of names that should be completed whenever 
a username is needed\&. If it is not set or the string on the line
doesn't match any of the strings in this list, all usernames will be
completed\&.
.TP
\fBusers\-hosts\fP
The values of this style should be of the form
`\fIuser\fP\fB@\fP\fIhost\fP' or `\fIuser\fP\fB:\fP\fIhost\fP'\&. It is used for
commands that need pairs of
user\- and hostnames\&.  For such commands, only the pairs from this style 
are used and if, for example, the username is already typed, then only 
the hostnames for which there is a pair with that username is defined\&.
.RS
.PP
If set for the \fBmy\-accounts\fP tag, this is used for commands such as
\fBrlogin\fP and \fBssh\fP; in this case the style should contain the names of
the user's own accounts on remote hosts\&.  If set for the \fBother\-accounts\fP
tag, it is used for commands such as \fBtalk\fP and \fBfinger\fP and should
contain other people's accounts\&.  Finally, it may also be used by some
commands with the \fBaccounts\fP tag\&.
.RE
.TP
\fBusers\-hosts\-ports\fP
Like \fBusers\-hosts\fP but used for commands like \fBtelnet\fP and
containing strings of the form `\fIuser\fP\fB@\fP\fIhost\fP\fB:\fP\fIport\fP'\&.
.TP
\fBverbose\fP
This is used in several contexts to decide if only a simple or a
verbose list of matches should be generated\&. For example some commands 
show descriptions for option names if this style is `true'\&.
.RS
.PP
The default value for this style is `true'\&.
.RE
.TP
\fBword\fP
This is used by the \fB_list\fP completer, which prevents the insertion of
completions until a second completion attempt when the line has not
changed\&.  The normal way of finding out if the line has changed is to
compare its entire contents between the two occasions\&.  If this style is
true, the comparison is instead performed only on the current word\&.
Hence if completion is performed on another word with the same contents,
completion will not be delayed\&.
.PP
.SH "CONTROL FUNCTIONS"
.PP
The initialization script \fBcompinit\fP redefines all the widgets
which perform completion to call the supplied widget function
\fB_main_complete\fP\&.  This function acts as a wrapper calling the
so\-called `completer' functions that generate matches\&.  If
\fB_main_complete\fP is called with arguments, these are taken as the
names of completer functions to be called in the order given\&.  If no
arguments are given, the set of functions to try is taken from the
\fBcompleter\fP style\&.  For example, to use normal completion and
correction if that doesn't generate any matches:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete _correct\fP
.fi
.RE
.PP
after calling \fBcompinit\fP\&. The default value for this style is
`\fB_complete _ignored\fP', i\&.e\&. normally only ordinary completion is tried,
first with the effect of the \fBignored\-patterns\fP style and then without
it\&.  The \fB_main_complete\fP function uses the return value of the completer
functions to decide if other completers should be called\&.  If the return
value is zero, no other completers are tried and the \fB_main_complete\fP
function returns\&.
.PP
If the first argument to \fB_main_complete\fP is a single hyphen, the
arguments will not be taken as names of completers\&. Instead, the
second argument gives a name to use in the \fIcompleter\fP field of the 
context and the other arguments give a command name and arguments to
call to generate the matches\&.
.PP
The following completer functions are contained in the distribution (users
may write their own):
.PP
.PD 0
.TP
.PD
\fB_all_matches\fP
This completer can be used to add a string consisting of all other
matches\&.  To ensure, that this string is always added, this completer
has to be used as the first completer in the list\&.  The
\fBavoid\-completer\fP style is used to decide if the string should be
added\&.  This will only be done if the matches were generated by a
completer not named by one of the values of the style\&.
.RS
.PP
This function also uses the style \fBold\-matches\fP\&.  If it is set to
`true' or to the string `\fBonly\fP' and there is a list of matches from 
a previous completion, those matches will be inserted in the command
line\&.  If it is set to the the string `\fBonly\fP', it will only insert
an old list and won't add the string for all matches of the list
currently being generated\&.
.PP
With the \fBold\-matches\fP style set, this completer should probably not 
be called unconditionally\&.  Instead one could use the \fB\-e\fP option of 
the \fBzstyle\fP builtin command to add a condition to the \fBcompleter\fP 
or to the \fBold\-matches\fP style\&.  Alternatively, one could use the
\fB_generic\fP function to bind \fB_all_matches\fP to a separate key
binding, for example:
.PP
.RS
.nf
\fBzle \-C all\-matches complete\-word _generic
bindkey '^Xa' all\-matches
zstyle ':completion:all\-matches::::' old\-matches only
zstyle ':completion:all\-matches:*' completer _all_matches\fP
.fi
.RE
.RE
.TP
\fB_approximate\fP
This completer function uses the \fB_complete\fP completer to generate
a list of strings for the context the cursor is currently in, allowing 
you to specify a maximum number of errors:  see the description of
approximate matching in
\fIzshexpn\fP(1)
for how errors are counted\&.  The resulting list of corrected and completed
strings is then presented to the user\&.  The intended use of this completer
function is to try after the normal \fB_complete\fP completer by setting:
.RS
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete _approximate\fP
.fi
.RE
.PP
This will give correcting completion if and only if
normal completion yields no possible completions\&.  When
corrected completions are found, the completer will normally start
menu completion allowing you to cycle through these strings\&.
.PP
This completer uses the tags \fBcorrections\fP and \fBoriginal\fP when
generating the possible corrections and the original string\&.  The
\fBformat\fP style for the former may contain the additional sequences
`\fB%e\fP' and `\fB%o\fP' which will be replaced by the number of errors
accepted to generate the corrections and the original string,
respectively\&.
.PP
As with all completers, \fB_approximate\fP uses its name without the
underscore in the \fIcompleter\fP field of the context name\&.  Once it
has started trying to generate matches, it will append a minus sign
and the number of errors accepted to its name\&.  \fB_approximate\fP will
first look for completions with one error, then two, and on so up to the
limit on the number of errors set by the \fBmax\-errors\fP style\&.
Hence on the first try the completer field of the context contains
`\fBapproximate\-1\fP', on the second try `\fBapproximate\-2\fP', and so on\&.
.PP
When \fB_approximate\fP is called from another function, the number of
errors to accept may be given with the \fB\-a\fP option\&.  Its argument
should be the same as the value of the \fBmax\-errors\fP style, all in one
string\&.
.PP
Note that this completer (and the \fB_correct\fP completer mentioned
below) can be quite expensive to call, especially when a large number
of errors are allowed\&.  One way to avoid this is to set up the
\fBcompleter\fP style using the \fB\-e\fP option to zstyle so that some
completers are only used when completion is attempted a second time on 
the same string, e\&.g\&.:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer '
  if [[ $_last_try != "$HISTNO$BUFFER$CURSOR" ]]; then
    _last_try="$HISTNO$BUFFER$CURSOR"
    reply=(_complete _match _prefix)
  else
    reply=(_ignored _correct _approximate)
  fi'\fP
.fi
.RE
.PP
This uses the \fBHISTNO\fP parameter and the \fBBUFFER\fP and \fBCURSOR\fP
special parameters that are available inside zle and completion
widgets to find out if the command line hasn't changed since the last
time completion was tried\&.  Only then are the \fB_ignored\fP,
\fB_correct\fP and \fB_approximate\fP completers called\&.
.RE
.TP
\fB_complete\fP
This completer generates all possible completions in a context\-sensitive
manner, i\&.e\&. using the settings defined with the \fBcompdef\fP function
explained above and the current settings of all special parameters\&.
This gives the normal completion behaviour\&.
.RS
.PP
To complete arguments of commands, \fB_complete\fP uses the utility function
\fB_normal\fP, which is in turn responsible for finding the particular
function; it is described below\&.  Various contexts of the form
\fB\-\fP\fIcontext\fP\fB\-\fP, as mentioned above for the \fB#compdef\fP tag, are
handled specially\&.  These are:
.PP
.PD 0
.TP
.PD
\fB\-array\-value\-\fP
for completion on the right hand side of an array\-assignment
(`\fBfoo=(\&.\&.\&.)\fP')\&.
.TP
\fB\-brace\-parameter\-\fP
for completing the name of a parameter expansion within braces
(`\fB${\&.\&.\&.}\fP')\&.
.TP
\fB\-command\-\fP
for completing in a command position\&.
.TP
\fB\-condition\-\fP
for completion inside conditions (`\fB[[\&.\&.\&.]]\fP')\&.
.TP
\fB\-default\-\fP
for generating completions when no special completion function is used\&.
.TP
\fB\-equal\-\fP
for completion of words beginning with an equals sign
.TP
\fB\-first\-\fP
for adding completions before any other completion functions are
tried; if this
function sets the \fB_compskip\fP parameter to \fBall\fP, no other
completion functions will be called, if it is set to a string
containing the substring \fBpatterns\fP, no pattern completion functions
will be called, and if it is set to a string containing \fBdefault\fP
the function for the `\fB\-default\-\fP' context will not be called, but
functions defined for commands will\&.
.TP
\fB\-math\-\fP
for completion inside mathematical contexts, such as
`\fB((\fP\&.\&.\&.\fB))\fP'\&.
.TP
\fB\-parameter\-\fP
for completing the name of a parameter expansion (`\fB$\&.\&.\&.\fP')\&.
.TP
\fB\-redirect\-\fP
for completion after a redirection operator\&.
.TP
\fB\-subscript\-\fP
for completion inside subscripts\&.
.TP
\fB\-tilde\-\fP
for completion after a tilde (`\fB~\fP') character, but before a slash\&.
.TP
\fB\-value\-\fP
for completion on the right hand side of an assignment\&.
.PP
Default implementations are supplied for each of these
contexts, in most cases named after the context itself
(e\&.g\&. completion for the `\fB\-tilde\-\fP' context is done by the function 
named `\fB_tilde\fP')\&.
.PP
Before trying to find a function for a specific context, \fB_complete\fP 
checks if the parameter `\fBcompcontext\fP' is set\&.  If it is set to an
array, the elements are taken to be the possible matches which will be
completed using the tag `\fBvalues\fP' and the description
`\fBvalue\fP'\&.   If it is set to an associative array, the keys are used
as the possible completions and the values (if non\-empty) are used as
descriptions for the matches\&.  If `\fBcompcontext\fP' is set to a string
containing colons, it should be of
the form `\fItag\fP\fB:\fP\fIdescr\fP\fB:\fP\fIaction\fP'\&.  In this case the
\fItag\fP and \fIdescr\fP give the tag and description to use and the
\fIaction\fP says what should be completed in one of the forms
described for the \fB_arguments\fP utility function below\&.
.PP
Finally, if `\fBcompcontext\fP' is set to a string without colons, the
value is taken as the name of the context to use and the function
defined for that context will be called\&.  For this purpose, there is a
special context named \fB\-command\-line\-\fP that completes whole command
lines (commands and their arguments) and is not used by the completion
system itself, but has a function handling completion for it\&.
.RE
.TP
\fB_correct\fP
Generate corrections, but not completions, for the current word; this is
similar to \fB_approximate\fP but will not allow any number of extra
characters at the cursor as that completer does, hence this is
similar to spell\-checking\&.  It calls \fB_approximate\fP but uses a
different \fIcompleter\fP field in the context name\&.
.RS
.PP
For example, with:
.PP
.RS
.nf
\fBzstyle ':completion:::::' completer _complete _correct _approximate
zstyle ':completion:*:correct:::' max\-errors 2 not\-numeric
zstyle ':completion:*:approximate:::' max\-errors 3 numeric\fP
.fi
.RE
.PP
correction will accept up to two errors\&.  If a numeric argument is
given, correction will not be performed, but correcting completion
will be, and will accept as many errors as given by the numeric
argument\&.  Without a numeric argument, first correction and then
correcting completion will be tried, with the first one accepting two
errors and the second one accepting three errors\&.
.PP
When \fB_correct\fP is called as a function, the number of errors to accept
may be given following the \fB\-a\fP option\&.  The argument should be the same
as the value of the \fBaccept\fP style, all in one string\&.
.PP
This completer function is intended to be used without the
\fB_approximate\fP completer or, as in the example, just before
it\&.  Using it after the \fB_approximate\fP completer is useless since
\fB_approximate\fP will at least generate the corrected strings
generated by the \fB_correct\fP completer \-\- and probably more\&.
.RE
.TP
\fB_expand\fP
This completer function does not really do completion, but instead
checks if the word on the command line is eligible for expansion and,
if it is, gives detailed control over how this expansion is done\&.  When
using this, one should not use the \fBexpand\-or\-complete\fP widget, but
instead use \fBcomplete\-word\fP, as \fBexpand\-or\-complete\fP
will expand the string on the line before the completion widget is
called\&.  Also, this completer should be called before the \fB_complete\fP 
completer function\&.
.RS
.PP
The tags used when generating expansions are \fBall\-expansions\fP for
the string containing all possible expansions, \fBexpansions\fP when
adding the possible expansions as single matches and \fBoriginal\fP when 
adding the original string from the line\&.  In which order these strings 
are generated and which of these strings are generated at all can be
controlled by using the \fBgroup\-order\fP style and by modifying the
\fBtag\-order\fP style, as usual\&.
.PP
The format string for \fBall\-expansions\fP and for \fBexpansions\fP may
contain the sequence `\fB%o\fP' which will be replaced by the original
string from the line\&.
.PP
Which kind of expansion is tried is controlled by the \fBsubstitute\fP,
\fBglob\fP and \fBsubst\-globs\-only\fP styles\&.
.PP
When \fB_expand\fP is called as a function, the different modes may be
selected with options\&.  The \fB\-s\fP to \fBsubstitute\fP, \fB\-g\fP to
\fBglob\fP and \fB\-o\fP to \fBsubst\-globs\-only\fP\&.
.RE
.TP
\fB_expand_alias\fP
If the word the cursor is on is an alias, it is expanded and no other
completers are called\&.  The types of aliases which are to be expanded can
be controlled with the \fBregular\fP, \fBglobal\fP and \fBdisabled\fP
styles\&.
.RS
.PP
This function is also a bindable command, see
the section `Bindable Commands' below\&.
.RE
.TP
\fB_history\fP
Complete words from the shell's command  history\&.  This completer 
uses the \fBremove\-all\-dups\fP, and \fBsort\fP styles also used by the
\fB_history_complete_word\fP bindable command, see
the section `Bindable Commands' below
and
the section `Completion System Configuration' above\&.
.TP
\fB_ignored\fP
The \fBignored\-patterns\fP style can be set to a list of patterns which are
compared against possible completions; matching ones are removed\&.
With this completer those matches can be reinstated, as
if no \fBignored\-patterns\fP style were set\&.  The completer actually
generates its own list of matches; which completers are used
for this is determined in the same way as for the \fB_prefix\fP
completer\&.
.RS
.PP
The \fBsingle\-ignored\fP style is used if only one
match could be generated\&.  It can be set to \fBshow\fP to prevent that match 
from being displayed or inserted into the line, or it can be set to
\fBmenu\fP, in which case the single match and the original string from the
line will be offered in a menu completion\&.
.RE
.TP
\fB_list\fP
This completer allows one to delay the insertion of matches until
completion is attempted a second time without the word on the line
being changed\&.  On the first attempt, only the list of matches will be
shown\&.  It is affected by the styles \fBcondition\fP and \fBword\fP, see
the section `Completion System Configuration' above\&.
.TP
\fB_match\fP
This completer is intended to be used after the \fB_complete\fP
completer\&. It allows one to give patterns on the command line and
to complete all strings matching these patterns from the set of
possible completions for the context the cursor is in, without having
to set the \fBGLOB_COMPLETE\fP option\&.
.RS
.PP
Normally this will be done by taking the pattern from the line,
inserting a `\fB*\fP' at the cursor position and comparing the resulting
pattern with the possible completions generated\&.  However, if the
\fBmatch\-original\fP style has a value of \fBonly\fP, no `\fB*\fP' will be
inserted\&.  If \fBmatch\-original\fP has any other non\-empty string as its
value, this completer will first try to generate matches without, then
with a `\fB*\fP' inserted at the cursor position\&.
.PP
The generated matches will be offered in a menu completion unless the
\fBinsert\-unambiguous\fP style is set to `true'\&.  In
this case menu completion will only be started if no unambiguous string
could be generated that is at least as long as the original string\&.
The style may also be set to the string `\fBpattern\fP'\&.  This will keep 
the pattern on the line intact as long as there isn't an unambiguous
completion with which it could be replaced\&.
.PP
Note that the matcher specifications defined globally or used by the
completion functions will not be used\&.
.RE
.TP
\fB_menu\fP
This completer is a simple example function implemented to show how
menu completion can be done in shell code\&.  It should be used as the
first completer and has the effect of making the code perform
menu completion\&.  Note that this is independent of the setting of the
\fBMENU_COMPLETE\fP option and does not work with the other
menu completion widgets such as \fBreverse\-menu\-complete\fP, or
\fBaccept\-and\-menu\-complete\fP\&.
.TP
\fB_oldlist\fP
This completer controls how the standard completion widgets behave
when there is an existing list of completions which may have been
generated by a special completion (i\&.e\&. a separately\-bound completion
command)\&.  It allows the ordinary completion keys to continue to use the
list of completions thus generated, instead of producing a new list of
ordinary contextual completions\&.
It should appear in the list of completers before any of
the widgets which generate matches\&.  It uses two styles: \fBold\-list\fP and
\fBold\-menu\fP, see
the section `Completion System Configuration' above\&.
.TP
\fB_prefix\fP
This completer can be used to try completion with the suffix (everything
after the cursor) ignored\&.  In other words, the suffix will not be
considered to be
part of the word to complete and hence does not need to be matched\&.  It
uses the \fBcompleter\fP style to decide which other completers to call to
try to generate matches\&.  If this style is unset, the list of completers
set for the current context is used \-\- except, of course,
the \fB_prefix\fP completer itself\&.  Furthermore, if this completer appears
more than once in the list of completers only those completers not
already tried by the last invocation of \fB_prefix\fP will be
called\&.
.RS
.PP
For example, consider this global \fBcompleter\fP style:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer \e 
    _complete _prefix _correct _prefix:foo\fP
.fi
.RE
.PP
Here, the \fB_prefix\fP completer tries normal completion but ignoring the
suffix\&.  If that doesn't generate any matches, and neither does
the call to the \fB_correct\fP completer after it, \fB_prefix\fP will 
be called a second time and, now only trying correction with the
suffix ignored\&.  If you want to use \fB_prefix\fP as the last resort and
try only normal completion, you can use:
.PP
.RS
.nf
\fBzstyle ':completion:*' completer _complete \&.\&.\&. _prefix
zstyle ':completion::prefix:*' completer _complete\fP
.fi
.RE
.PP
The \fBadd\-space\fP style is also used\&.  If it is set to `true' then
\fB_prefix\fP will insert a space between the matches generated (if any) 
and the suffix\&.
.PP
Note that this completer is only useful if the
\fBCOMPLETE_IN_WORD\fP option is set; otherwise, the cursor will
be moved to the end of the current word before the completion code is
called and hence there will be no suffix\&.
.RE
.RE
.PP
.SH "BINDABLE COMMANDS"
.PP
In addition to the context\-dependent completions provided, which are
expected to work in an intuitively obvious way, there are a few widgets
implementing special behaviour which can be bound separately to keys\&.  The
following is a list of these and their default bindings\&.
.PP
.PD 0
.TP
.PD
\fB_bash_completions\fP
This function is used by two widgets, \fB_bash_complete\-word\fP and
\fB_bash_list\-choices\fP\&.  It exists to provide compatibility with
completion bindings in bash\&.  The last character of the binding determines
what is completed: `\fB!\fP', command names; `\fB$\fP', environment variables;
`\fB@\fP', host names; `\fB/\fP', file names; `\fB~\fP' user names\&.  In bash, the
binding preceded by `\fB\ee\fP' gives completion, and preceded by `\fB^X\fP'
lists options\&.  As some of these bindings clash with standard zsh
bindings, only `\fB\ee~\fP' and `\fB^X~\fP' are bound by default\&.  To add the
rest, the following should be added to \fB\&.zshrc\fP after \fBcompinit\fP has
been run:
.RS
.PP
.RS
.nf
\fBfor key in '!' '$' '@' '/' '~'; do
  bindkey "\ee$key" _bash_complete\-word
  bindkey "^X$key" _bash_list\-choices
done\fP
.fi
.RE
.PP
This includes the bindings for `\fB~\fP' in case they were already bound to
something else; the completion code does not override user bindings\&.
.RE
.TP
\fB_correct_filename (^XC)\fP
Correct the filename path at the cursor position\&.  Allows up to six errors
in the name\&.  Can also be called with an argument to correct
a filename path, independently of zle; the correction is printed on
standard output\&.
.TP
\fB_correct_word\fP (^Xc)
Performs correction of the current argument using the usual contextual
completions as possible choices\&. This stores the string
`\fBcorrect\-word\fP' in the \fIfunction\fP field of the context name and
then calls the \fB_correct\fP completer\&.
.TP
\fB_expand_alias (^Xa)\fP
This function can be used as a completer and as a bindable command\&.
It expands the word the cursor is on if it is an alias\&.  The types of
aliases expanded can be controlled with the \fBregular\fP, \fBglobal\fP and
\fBdisabled\fP styles\&.
.RS
.PP
When used as a bindable command there is one additional feature that
can be selected by setting the \fBcomplete\fP style to `true'\&.  In this
case, if the word isn't the name of an alias, \fB_expand_alias\fP tries
to complete the word to a full alias name without expanding it (but
leaving the cursor directly after the completed word so that invoking
\fB_expand_alias\fP once more will expand the now\-complete alias name)\&.
.RE
.TP
\fB_expand_word (^Xe)\fP
Performs expansion on the current word:  equivalent to the standard
\fBexpand\-word\fP command, but using the \fB_expand\fP completer\&.  Before
calling it, the \fIfunction\fP field is set to `\fBexpand\-word\fP'\&.
.TP
\fB_generic\fP
This function is not defined as a widget and not bound by
default\&. However, it can be used to define a widget and will then
store the name of the widget in the \fIfunction\fP field of the context 
and call the completion system\&. This allows custom completion widgets
with their own set of style settings to be easily defined\&. For example, 
to define a widget that does normal completion and starts
menu selection, one could do:
.RS
.PP
.RS
.nf
\fBzle \-C foo complete\-word _generic
bindkey '\&.\&.\&.' foo
zstyle ':completion:foo:*' menu yes select=1\fP
.fi
.RE
.RE
.TP
\fB_history_complete_word\fP (\ee/)
Complete words from the shell's command history\&. This uses the
\fBlist\fP, \fBremove\-all\-dups\fP, \fBsort\fP, and \fBstop\fP styles\&.
.TP
\fB_most_recent_file (^Xm)\fP
Complete the name of the most recently modified file matching the pattern
on the command line (which may be blank)\&.  If given a numeric argument
\fIN\fP, complete the \fIN\fPth most recently modified file\&.  Note the
completion, if any, is always unique\&.
.TP
\fB_next_tags\fP (^Xn)
This command alters the set of matches used to that for the next tag, or
set of tags, either as given by the \fBtag\-order\fP style or as set by
default; these matches would otherwise not be available\&.
Successive invocations of the command cycle through all possible sets of
tags\&.
.TP
\fB_read_comp (^X^R)\fP
Prompt the user for a string, and use that to perform completion on the
current word\&.  There are two possibilities for the string\&.  First, it can
be a set of words beginning `\fB_\fP', for example `\fB_files \-/\fP', in which
case the function with any arguments will be called to generate the
completions\&.  Unambiguous parts of the function name will be completed
automatically (normal completion is not available at this point) until a
space is typed\&.
.RS
.PP
Second, any other string will be passed as a set of arguments to
\fBcompadd\fP and should hence be an expression specifying what should
be completed\&.
.PP
A very restricted set of editing commands is available when reading the
string:  `\fBDEL\fP' and `\fB^H\fP' delete the last character; `\fB^U\fP' deletes
the line, and `\fB^C\fP' and `\fB^G\fP' abort the function, while `\fBRET\fP'
accepts the completion\&.  Note the string is used verbatim as a command
line, so arguments must be quoted in accordance with standard shell rules\&.
.PP
Once a string has been read, the next call to \fB_read_comp\fP will use the
existing string instead of reading a new one\&.  To force a new string to be
read, call \fB_read_comp\fP with a numeric argument\&.
.RE
.TP
\fB_complete_debug (^X?)\fP
This widget performs ordinary completion, but captures in a temporary file
a trace of the shell commands executed by the completion system\&.  Each
completion attempt gets its own file\&.  A command to view each of these
files is pushed onto the editor buffer stack\&.
.TP
\fB_complete_help (^Xh)\fP
This widget displays information about the context names, 
the tags, and the completion functions used 
when completing at the current cursor position\&. If given a numeric
argument other than \fB1\fP (as in `\fBESC\-2 ^Xh\fP'), then the styles
used and the contexts for which they are used will be shown, too\&.
.RS
.PP
Note that the information about styles may be incomplete; it depends on the
information available from the completion functions called, which in turn
is determined by the user's own styles and other settings\&.
.RE
.TP
\fB_complete_tag (^Xt)\fP
This widget completes symbol tags created by the \fBetags\fP or \fBctags\fP
programmes (note there is no connection with the completion system's tags)
stored in a file \fBTAGS\fP, in the format used by \fBetags\fP, or \fBtags\fP, in the
format created by \fBctags\fP\&.  It will look back up the path hierarchy for
the first occurrence of either file; if both exist, the file \fBTAGS\fP is
preferred\&.  You can specify the full path to a \fBTAGS\fP or \fBtags\fP file by
setting the parameter \fB$TAGSFILE\fP or \fB$tagsfile\fP respectively\&.
The corresponding completion tags used are \fBetags\fP and \fBvtags\fP, after
emacs and vi respectively\&.
.PP
.SH "UTILITY FUNCTIONS"
.PP
Descriptions follow for utility functions that may be
useful when writing completion functions\&.  Most of these reside in the
\fBBase\fP subdirectory\&. Like the example 
functions for commands in the distribution, the utility functions
generating matches all follow the convention of returning zero if they
generated completions and non\-zero if no matching completions could be 
added\&.
.PP
When writing completion functions or other ZLE widgets that call
completion, it might be interesting to know about two more features
offered by the \fB_main_complete\fP function\&. The arrays
\fBcompprefuncs\fP and \fBcomppostfuncs\fP may be set to contain names of
functions that are to be called immediately before or after completion 
has been tried\&. The functions will only be called once, unless they
put themselves into the arrays again\&.
.PP
.PD 0
.TP
.PD
\fB_all_labels\fP [ \fB\-12VJ\fP ] \fItag\fP \fIname\fP \fIdescr\fP [ \fIcommand\fP \fIargs\fP \&.\&.\&. ]
This is a convenient interface to the \fB_next_label\fP function below,
implementing the loop shown in the \fB_next_label\fP example\&.  The
\fIcommand\fP is the one that should be called to generate the matches\&. The
options stored in the parameter \fIname\fP will automatically be inserted
into the \fIargs\fP given to the \fIcommand\fP\&.  Normally, they are put
directly after the \fIcommand\fP, but if one of the \fIargs\fP is a single
hyphen, they are inserted directly before that\&. If the hyphen is the last
argument, that will be removed from the argument list before the
\fIcommand\fP is called\&. This allows \fB_all_labels\fP to be used in almost all
cases where the matches can be generated by a single call to the
\fBcompadd\fP builtin command or by a call to one of the utility functions\&.
.RS
.PP
For example:
.PP
.RS
.nf
\fBlocal expl
\&.\&.\&.
if _requested foo; then
  \&.\&.\&.
  _all_labels foo expl '\&.\&.\&.' compadd \&.\&.\&. \- $matches
fi\fP
.fi
.RE
.PP
Will complete the strings from the \fBmatches\fP parameter, using
\fBcompadd\fP with additional options which will take precedence over
those generated by \fB_all_labels\fP\&.
.RE
.TP
\fB_alternative\fP [ \fB\-C\fP \fIname\fP ] \fIspecs\fP \&.\&.\&.
This function is useful in simple cases where multiple tags are available\&.
Essentially, it implements a loop like the one described for the \fB_tags\fP
function above\&.
.RS
.PP
The tags to use and the action to perform if a tag is requested are
described using the \fIspecs\fP which are of the form:
`\fItag\fP\fB:\fP\fIdescr\fP\fB:\fP\fIaction\fP'\&. The \fItag\fPs are offered using
\fB_tags\fP and if the tag is requested, the \fIaction\fP is executed with the
given description \fIdescr\fP\&.  The \fIaction\fPs supported are those used
by the \fB_arguments\fP function (described below), without the
`\fB\->\fP\fIstate\fP' and `\fB=\fP\fI\&.\&.\&.\fP' forms\&.
.PP
For example, the \fIaction\fP may be a simple function call\&. With that
one could do:
.PP
.RS
.nf
\fB_alternative \e 
    'users:user:_users' \e 
    'hosts:host:_hosts'\fP
.fi
.RE
.PP
to offer usernames and hostnames as possible matches (which are
generated by the \fB_users\fP and \fB_hosts\fP functions respectively)\&.
.PP
Note that, like \fB_arguments\fP this will also use \fB_all_labels\fP to execute 
the actions, so one doesn't need to call that explicitly unless
another tag is to be used, for example in a function called from
\fB_alternative\fP\&.
.PP
Like \fB_tags\fP this function supports the \fB\-C\fP option to give a
different name for the argument context field\&.
.RE
.TP
\fB_arguments\fP [ \fB\-ACS\fP ] [ \fB\-O\fP \fIname\fP ] [ \fB\-M\fP \fImatchspec\fP ] \fIspec\fP \&.\&.\&.
This function can be used to complete words on the line by describing the
options and arguments which may be passed to the command for which
completion is being performed\&.  The description is given as arguments to
this function, with each \fIspec\fP describing one option or normal
argument of the command\&.  The forms of \fIspec\fP understood are:
.RS
.PP
.PD 0
.TP
.PD 0
\fIn\fP\fB:\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD
\fIn\fP\fB::\fP\fImessage\fP\fB:\fP\fIaction\fP
This describes the \fIn\fP'th normal argument\&.  The \fImessage\fP will be 
printed above the matches generated and the \fIaction\fP says what can
be completed in this position (see below)\&.  If there are two colons
before the \fImessage\fP, this describes an optional argument\&.  If the
\fImessage\fP contains only white space, nothing will be printed above
the matches unless the action adds an explanation string itself\&.
.TP
.PD 0
\fB:\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD
\fB::\fP\fImessage\fP\fB:\fP\fIaction\fP
Like the previous one, but describing the \fInext\fP argument\&. I\&.e\&. if
you want to describe all arguments a command can get, you can leave
out the numbers in the description and just use this form to describe
them one after another in the order they have to appear on the line\&.
.TP
.PD 0
\fB*:\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD 0
\fB*::\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD
\fB*:::\fP\fImessage\fP\fB:\fP\fIaction\fP
This describes how arguments (usually non\-option arguments, those not
beginning with \fB\-\fP or \fB+\fP) are to be completed when no description
with one of the first two forms was given\&. This also means that any number
of arguments can be completed\&.
.RS
.PP
With two colons before the \fImessage\fP, the \fBwords\fP special array and
the \fBCURRENT\fP special parameter are modified to refer only to the
normal arguments when the \fIaction\fP is executed or evaluated\&.  With
three colons before the \fImessage\fP they are modified to refer only to
the normal arguments covered by this description\&.
.RE
.TP
\fIoptspec\fP[\fIdescription\fP \&.\&.\&.]
This describes an option and (if \fIdescription\fP is given) the arguments
that have to come after the option\&.  If no \fIdescription\fP is given, this
means to offer only the option name as a possible completion in the right
places\&.  (Note that the brackets, above, around \fIdescription\fP, indicate
that zero or more \fIdescription\fPs may appear; but the brackets are not
themselves part of this format\&.  If brackets are used, they are part of
the \fIoptspec\fP; see below\&.)
.RS
.PP
In the descriptions below, the option names represented by \fIoptname\fP
are normally taken to be multi\-character names, and a word from the line
is considered to contain only one option (or none)\&.  By giving the \fB\-s\fP
option to \fB_arguments\fP before the first \fIspec\fP, each \fIoptname\fP is
considered to be a single character and each word from the line may
contain more than one such option letter\&.  However, words beginning with
two hyphens (like `\fB\-\fP\fB\-prefix\fP') are still considered to contain only
one option name\&.  This allows the use of the `\fB\-s\fP' option to describe
single\-letter options together with such long option names\&.
.PP
The \fB\-s\fP option may be combined with the option \fB\-w\fP to say that more
option characters are to be expected even after an option that takes an
argument\&.  For example, if a command takes the options `\fBa\fP' and `\fBb\fP',
where `\fBa\fP' takes an argument in the next word, \fB_arguments\fP would
normally not complete the other option directly after `\fB\-a\fP', but it would
allow that if given the \fB\-w\fP option\&.
.PP
Similarly, the option \fB\-W\fP may be given together with \fB\-s\fP to force
completion of single\-letter options even after options that get an
argument in the same word\&.  For example, if a command takes the options
`\fBa\fP' and `\fBb\fP', where `\fBa\fP' needs an argument in the same word,
directly after the option character, \fB_arguments\fP would normally only
execute the action for that argument and not offer other single\-letter
options as possible completions\&.  If given the \fB\-W\fP option, it will
offer other options as possible completions after executing the action
for the argument\&.  Note that, depending on the action, this may mean
that the other options can't really be completed, but at least they will
be listed\&.  For more control, use an utility function like \fB_guard\fP in
the argument's action\&.
.PP
The forms of \fIoptspec\fP are:
.PP
.PD 0
.TP
.PD
\fB*\fP\fIoptspec\fP
If the option may be given more than once, a star (`\fB*\fP') must be
added in front of one of the following forms of \fIoptspec\fP\&.  Otherwise,
if the option is already on the line and to the left of the cursor, it
is not offered as a possible completion again\&.
.TP
.PD 0
\fB\-\fP\fIoptname\fP
.TP
.PD
\fB+\fP\fIoptname\fP
In the simplest form the \fIoptspec\fP is just the option name beginning
with a minus or a plus sign, such as `\fB\-foo\fP'\&.  The first argument for
the option (if any) must follow as a \fIseparate\fP word directly after the
option\&.
.RS
.PP
If the command accepts the option with either a leading minus or a leading
plus sign, use either `\fB\-+\fP\fIoptname\fP' or `\fB+\-\fP\fIoptname\fP' to
define both variants at once\&.
.PP
In all the following forms, the leading `\fB\-\fP' may be replaced or paired
with `\fB+\fP' in this way\&.
.RE
.TP
\fB\-\fP\fIoptname\fP\fB\-\fP
The first argument of the option must come directly after the option name
\fIin the same word\fP, as in `\fB\-foo\-:\fP\fI\&.\&.\&.\fP'\&.
.TP
\fB\-\fP\fIoptname\fP\fB+\fP
The first argument may appear immediately after \fIoptname\fP in the same
word, or may instead appear as a separate word after the option\&.
.TP
\fB\-\fP\fIoptname\fP\fB=\fP
The argument may appear as the next word, or in same word as the option
name provided that it is separated from it by an equals sign\&.
.TP
\fB\-\fP\fIoptname\fP\fB=\-\fP
The argument to the option must appear after an equals sign in the same
word, and may not be given in the next argument\&.
.TP
\fIoptspec\fP\fB[\fP\fIexplanation\fP\fB]\fP
An explanation string may be appended to any of the preceding forms of
\fIoptspec\fP by enclosing it in brackets, as in `\fB\-q[query operation]\fP'\&.
.RS
.PP
The \fBverbose\fP style is used to decide if these explanation strings
should be displayed with the option in a completion listing\&.
.PP
If no bracketed explanation string is given but the \fBauto\-description\fP
style is set and only one argument is described for this \fIoptspec\fP, the
value of the style is displayed, with any appearance of the sequence
`\fB%d\fP' in it replaced by the \fImessage\fP of the first \fIdescription\fP
that follows the \fIoptspec\fP; see below\&.
.RE
.RE
.PP
Note that the special meaning of a leading or trailing \fB\-\fP or \fB+\fP in
\fIoptspec\fP means that when the command to be completed accepts options
like `\fB\-+\fP' or `\fB\-=\fP', the second character has to be quoted with a
backslash, as in `\fB\-\e+\fP'\&.
.PP
Each \fIdescription\fP following an \fIoptspec\fP must take one of the
following forms:
.PP
.PD 0
.TP
.PD 0
\fB:\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD
\fB::\fP\fImessage\fP\fB:\fP\fIaction\fP
Describes a mandatory argument with one colon, or an optional argument
with two colons\&.  As in other forms of \fIspec\fP, the \fImessage\fP will be
printed above the matches generated (unless it contains only white
space, see above) and the \fIaction\fP says what can be
completed in this position\&.
.TP
.PD 0
\fB:*\fP\fIpattern\fP\fB:\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD 0
\fB:*\fP\fIpattern\fP\fB::\fP\fImessage\fP\fB:\fP\fIaction\fP
.TP
.PD
\fB:*\fP\fIpattern\fP\fB:::\fP\fImessage\fP\fB:\fP\fIaction\fP
This describes multiple arguments\&.  Only the \fIlast\fP description may be
given in this form\&.  If the \fIpattern\fP is empty (i\&.e\&., \fB:*:\fP), all
following words on the line are to be completed as described by the
\fIaction\fP; otherwise, all words up to a word matching the \fIpattern\fP
are to be completed using the \fIaction\fP\&.
.RS
.PP
When the \fImessage\fP is preceded by two colons, the \fBwords\fP special
array and the \fBCURRENT\fP special parameter are modified during the
execution or evaluation of the \fIaction\fP to refer only to the words
after the option\&.  When preceded by three colons, they are modified to
refer only to the words covered by this description\&.
.PP
Note that only one such `\fB:*\fP'\-specification is useful
and no other argument specification may be given after it\&.
.RE
.RE
.RE
.RE
.PP
To include a colon in any \fIoptname\fP, \fImessage\fP, or \fIaction\fP
anywhere above, it has to be preceded by a backslash, as `\fB\e:\fP'\&.
.PP
Each of the six forms of \fIspec\fP (yes, there are six, keep track of
the nestings) may be preceded by a list
of option names and argument numbers with which the option or argument
described is mutually exclusive\&.  This list is given in parentheses, as
in `\fB(\-two \-three 1)\-one:\&.\&.\&.\fP' or `\fB(\-foo):\&.\&.\&.\fP'\&.  In the first
example, the options `\fB\-two\fP' and `\fB\-three\fP' and the first
argument will not be offered as possible completions if the option
`\fB\-one\fP' is on the line before the cursor, and in the second example
the option `\fB\-foo\fP' will not be offered if the argument described by
the specification is on the line\&.
.PP
The list may also contain a single star (\fB*\fP) as one of its elements to
specify that the description for the rest arguments (i\&.e\&. a specification
of the form `\fB*:\&.\&.\&.\fP') should not be used, a colon (\fB:\fP) to specify
that the descriptions for all normal (non\-option\-) arguments should not be
used and a hyphen (\fB\-\fP) to specify that the descriptions for all options
should not be used\&.  This paragraph desperately needs rewriting\&.
.PP
To simplify writing writing functions that call \fB_arguments\fP more
than once, the \fIspecs\fP may also start with the character `\fB!\fP'
(exclamation mark) to make the spec \fInot\fP be completed\&.  However, if
this is used with one of the forms describing options, the option (and 
its arguments, if it takes any) will be understood and skipped if they 
appear on the command line\&.  It's just that the option itself will not
be completed\&. This is intended to be used with an array containing the 
options used in the first call to \fBarguments\fP\&.  The second call can
then use `\fB\e!${^global_options}\fP' to ignore those options and
complete only the ones understood in the current context\&.
.PP
In every case above, the \fIaction\fP determines how the possible
completions should be generated\&.  In places where no sensible matches can
be generated, the action should consist of only a space\&. This will make
the \fImessage\fP be displayed but no possible completions listed\&. Note
that even in this case the colon at the end of the \fImessage\fP is
needed\&. The only case where it can be left is when neither a \fImessage\fP,
nor a \fIaction\fP is given\&.
.PP
Except for the `\fB\->\fP\fIstring\fP' form below, the \fIaction\fP will be
executed by calling the \fB_all_labels\fP function to process all tag labels,
so one doesn't need to call that explicitly unless another tag is to
be used, for example in a function called in the \fIaction\fP\&.
.PP
When only one of a fixed set of strings can be completed, the \fIaction\fP
can consist of these strings as a list in parentheses, as in:
.PP
.RS
.nf
\fB\fB:foo:(foo bar baz\fP\fB)\fP\fP
.fi
.RE
.PP
Such a list in doubled parentheses should contain strings consisting of
the string to complete followed by `\fB\e:\fP' and a description, as in:
.PP
.RS
.nf
\fB\fB:foo:((a\e:bar b\e:baz\fP\fB))\fP\fP
.fi
.RE
.PP
The matches will be listed together with their descriptions if the
\fBdescription\fP style for the \fBvalues\fP tag is set\&.
.PP
An \fIaction\fP of the form `\fB\->\fP\fIstring\fP' is used by functions
that implement a state machine\&. In this case, the `\fIstring\fP's (with
all leading and trailing spaces and tabs removed) of all actions that
have to be used will be stored in the global array \fBstate\fP\&.  The
function returns with a non\-zero return value if the cursor is not in
a position where options can be completed or if the current word could 
not be completed to an option\&.  But if the \fB\-R\fP option is given to
\fB_arguments\fP, the function will instead return with a return
value of 300 (to make it distinguishable from other return values)
after setting the global `\fBcontext\fP', `\fBline\fP' and `\fBopt_args\fP'
parameters as described below, and without resetting any changes made
to the special parameters such as \fBPREFIX\fP and \fBwords\fP\&.  This
enables wrapper functions around \fB_arguments\fP to be able to find out
if they have to make sure that the special completion parameters are
not reset when they return\&.
.PP
Note that this means that a function calling \fB_arguments\fP with at least
one action containing such a `\fB\->\fP\fIstring\fP' has to declare
appropriate local parameters as in:
.PP
.RS
.nf
\fBlocal context state line
typeset \-A opt_args\fP
.fi
.RE
.PP
This will ensure that \fB_arguments\fP does not create unused global
parameters\&.
.PP
A string in braces is evaluated to generate the matches and if the
\fIaction\fP does not begin with an opening parentheses or brace, it
is also split into separate words and executed\&. If the \fIaction\fP
starts with a space, this list of words will be invoked unchanged,
otherwise it will be invoked with some extra strings placed after the
first word which can be given as arguments to the \fBcompadd\fP builtin
command and which make sure that the \fImessage\fP given
in the description will be shown above the matches\&. These arguments
are taken from the array parameter `\fBexpl\fP' which will be set up
before executing the \fIaction\fP and hence may be used in it (normally 
in an expansion like `\fB$expl[@]\fP')\&.
.PP
If the \fIaction\fP starts with `\fB= \fP' (an equals sign followed by a
space), \fB_arguments\fP will insert the contents of the \fIargument\fP
field of the current context as the new first element in the \fBwords\fP 
special array and increments the value of the \fBCURRENT\fP special
parameter\&. In other words, it inserts a dummy element in the \fBwords\fP 
array and makes \fBCURRENT\fP still point to the word in that array
where the cursor is\&. This is only really useful when used with one of
the forms that make \fB_arguments\fP modify the \fBwords\fP array to
contain only some of the words from the line, i\&.e\&. one of the argument 
description forms where the \fImessage\fP is preceded by two or three
colons\&. For example, when the function called in the action for such
an argument itself uses \fB_arguments\fP, the dummy element is needed to 
make that second call to \fB_arguments\fP use all words from the
restricted range for argument parsing\&. Without the inserted dummy
element, the first word in the range would be taken (by the second
\fB_arguments\fP) to be the command name and hence ignored\&.
.PP
During the evaluation or execution of the action the array `\fBline\fP'
will be set to the command name and normal arguments from the command
line, i\&.e\&. to the words from the command line excluding all options
and their arguments\&. These are stored in the associative array
`\fBopt_args\fP', using the option names as keys and their arguments as
the values\&. For options that have more than one argument these are
given as one string, separated by colons\&. All colons in the original
arguments are preceded with backslashes\&.
.PP
The parameter `\fBcontext\fP' (set only in the calling function when
using an action of the form `\fB\->\fP\fIstring\fP', not during the
evaluation of other \fIaction\fPs) is set to the automatically
created context names\&. These are either strings of the form
`\fBoption\fP\fI\-opt\fP\fB\-\fP\fIn\fP' for the \fIn\fP'th argument of the
option \fI\-opt\fP, or strings of the form `\fBargument\-\fP\fIn\fP' for
the \fIn\fP'th argument (for rest arguments the \fIn\fP is the string
`\fBrest\fP')\&. For example, when completing the argument of the \fB\-o\fP
option, the name is `\fBoption\-o\-1\fP' and for the second normal
(non\-option\-) argument it is `\fBargument\-2\fP'\&.
.PP
Also, during the evaluation of the \fIaction\fP, the context name in
the \fBcurcontext\fP parameter is changed by appending the same
string that is stored in the \fBcontext\fP parameter\&.
.PP
It is also possible to specify multiple sets of options and
arguments with the sets separated by single hyphens\&.  The specifications
before the first hyphen are shared by all sets given after the first
hyphen\&.  The first word in every other set gives the name of the
set\&. This name may appear in exclusion lists in the specifications,
either alone or before one of the possible values described above
(with a `\fB\-\fP' between the name and the rest)\&.
.PP
For example:
.PP
.RS
.nf
\fB_arguments \e 
    \-a \e 
  \- set1 \e 
    \-c \e 
  \- set2 \e 
    \-d \e 
    ':arg:(x2 y2)'\fP
.fi
.RE
.PP
This defines two sets\&. When the command line contains the option
`\fB\-c\fP', the `\fB\-d\fP' option and the argument will not be considered
possible completions\&. When it contains `\fB\-d\fP' or an argument, the
option `\fB\-c\fP' will not be completed any more, but if `\fB\-a\fP' is
given, both sets will still be considered valid, because it appears
before the first hyphen, so both sets contain this option\&.
.PP
If the name\-string is of the form `\fB(\fP\fIname\fP\fB)\fP' then 
all specifications in the set have an implicit exclusion list
containing the name of the set, i\&.e\&. all specifications are mutual
exclusive with all other specifications in the same set\&. This is
useful for defining multiple sets of options which are mutually
exclusive and in which the options are aliases for each other\&. E\&.g\&.:
.PP
.RS
.nf
\fB_arguments \e 
    \-a \-b \e 
  \- '(compress)' \e 
    {\-c,\-\-compress}'[compress]' \e 
  \- '(uncompress)' \e 
    {\-d,\-\-decompress}'[decompress]'\fP
.fi
.RE
.PP
Note that using multiple sets will be slower than using only one set
because the completion code has to parse the command line once for
every set\&. So more than one set should only be used if the command
syntax is too complicated\&. Note also that an option specification with
rest\-arguments (as in `\fB\-foo:*:\&.\&.\&.\fP') often allows the use of
multiple sets to be avoided\&.
.PP
To simplify the specifications for commands with standard option
parsing, the options \fB\-S\fP and \fB\-A\fP may be given\&.  With \fB\-S\fP, no
option will be completed after a `\fB\-\fP\fB\-\fP' on the line and this
argument will otherwise be ignored\&. With \fB\-A\fP, no options will be
completed after the first non\-option argument on the line\&.  The \fB\-A\fP 
has to be followed by a pattern matching all strings which are not to
be taken as arguments\&. For example, to make \fB_arguments\fP stop
completing options after the first normal argument, but ignoring all
strings starting with a hyphen even if they are not described by one
of the \fIoptspec\fPs, one would use: `\fB\-A "\-*"\fP'\&.
.PP
Another option supported is `\fB\-O\fP \fIname\fP'\&. The \fIname\fP will be
taken as the name of an array and its elements will be given to
functions called to generate matches when executing the
\fIactions\fP\&. For example, this allows one to give options for the
\fBcompadd\fP builtin that should be used for all \fIaction\fPs\&.
.PP
Also, the \fB\-M\fP option followed by a string may be given before the
first description\&. The string will be used as the match specification
when completing option names and values instead of the default
`\fBr:|[_\-]=* r:|=*\fP'\&. 
.PP
Finally, the option \fB\-C\fP can be given to make \fB_arguments\fP modify
the \fBcurcontext\fP parameter when an action of the form
`\fB\->\fP\fIstate\fP' is used\&. This parameter is used to keep track of
the current context and in this case it (and not the parameter
\fBcontext\fP as explained above) has to be made local to make sure that 
calling functions don't use the modified value\&. Also, the local
version of \fBcurcontext\fP has to be initialised with the old value as
in:
.PP
.RS
.nf
\fBlocal curcontext="$curcontext"\fP
.fi
.RE
.PP
The function can also be made to automatically complete long options
for commands that support the `\fB\-\fP\fB\-help\fP' option as, for example,
most of the GNU commands do\&. For this, the string `\fB\-\fP\fB\-\fP' must be
given as one argument and if it is, the command from the line is
invoked with the `\fB\-\fP\fB\-help\fP' option and its output is parsed to find
possible option names\&. Note that this means that you should be careful
to make sure that this feature is not used for a command that does not
support this option\&.
.PP
For such automatically found options that get an argument after an
`\fB=\fP', the function also tries
to automatically find out what should be completed as the argument\&.
The possible completions for option\-arguments can be described with
the arguments after the `\fB\-\fP\fB\-\fP' (which are not used as described
above)\&. Each argument contains one description of the form
`\fIpattern\fP\fB:\fP\fImessage\fP\fB:\fP\fIaction\fP'\&. The \fImessage\fP and
the \fIaction\fP have the same format as for the normal option
descriptions described above\&. The \fIaction\fP will be executed to
complete arguments of options whose description in the output of the
command from the line with the `\fB\-\fP\fB\-help\fP' option matches the
\fIpattern\fP\&. For example:
.PP
.RS
.nf
\fB_arguments \-\- '*\e*:toggle:(yes no)' \e 
              '*=FILE*:file:_files' \e 
              '*=DIR*:directory:_files \-/'\fP
.fi
.RE
.PP
Here, `\fByes\fP' and `\fBno\fP' will be completed as the argument of
options whose description ends in a star, file names for options that
contain the substring `\fB=FILE\fP' in the description, and paths for
options whose description contains `\fB=DIR\fP'\&. In fact, the last two
patterns are not needed since this function always completes files
for option descriptions containing `\fB=FILE\fP' and paths for option
descriptions that contain `\fB=DIR\fP' or `\fB=PATH\fP'\&. These builtin
patterns can be overridden by patterns given as arguments, however\&.
.PP
Note also that \fB_arguments\fP tries to find out automatically if the
argument for an option is optional\&. If it fails to automatically
detect this, the colon before the \fImessage\fP can be doubled to tell
it about this as described for the normal option descriptions above\&.
.PP
If the \fIpattern\fP ends in `\fB(\-)\fP', this will removed from the
pattern and the \fIaction\fP will be used only directly after the
`\fB=\fP', not in the next word\&. I\&.e\&., this is like a normal
specification as described above using `\fB=\-\fP'\&.
.PP
The option `\fB\-i\fP \fIpatterns\fP' (which must be given after the
`\fB\-\fP\fB\-\fP') can be used to give patterns for options which should not be
completed\&. The patterns can be given as the name of an array parameter
or as a literal list in parentheses\&. E\&.g\&. `\fB\-i
"(\-\fP\fB\-(en|dis)able\-FEATURE*)"\fP' will make the options
`\fB\-\fP\fB\-enable\-FEATURE\fP' and `\fB\-\fP\fB\-disable\-FEATURE\fP' be ignored\&. The
option `\fB\-s\fP \fIpairs\fP' (again, after the `\fB\-\fP\fB\-\fP') can be used to
describe option aliases\&. Each \fIpair\fP consists of a pattern and a
replacement\&. E\&.g\&. some \fBconfigure\fP\-scripts describe options only as
`\fB\-\fP\fB\-enable\-foo\fP', but also accept `\fB\-\fP\fB\-disable\-foo\fP'\&. To allow
completion of the second form, one would use `\fB\-s "(#\-\fP\fB\-enable\-
\-\fP\fB\-disable\-)"\fP'\&.
.PP
Example:
.PP
.RS
.nf
\fB_arguments '\-l+:left border:' \e 
           '\-format:paper size:(letter A4)' \e 
           '*\-copy:output file:_files::resolution:(300 600)' \e 
           ':postscript file:_files \-g \e*\&.\e(ps\e|eps\e)' \e 
           '*:page number:'\fP
.fi
.RE
.PP
This describes three options: `\fB\-l\fP', `\fB\-format\fP', and
`\fB\-copy\fP'\&. The first one gets one argument described as `\fIleft
border\fP' for which no completion will be offered because of the empty
action\&. The argument may come directly after the `\fB\-l\fP' or it may be 
given as the next word on the line\&. The `\fB\-format\fP' option gets one
argument (in the next word) described as `\fIpaper size\fP' for which
only the strings `\fBletter\fP' and `\fBA4\fP' will be completed\&. The
`\fB\-copy\fP' option differs from the first two in that it may appear
more than once on the command line and in that it accepts two
arguments\&. The first one is mandatory and will be completed as a
filename\&. The second one is optional (because of the second colon
before the description `\fIresolution\fP') and will be completed from
the strings `\fB300\fP' and `\fB600\fP'\&.
.PP
The last two descriptions say what should be completed as
arguments\&. The first one describes the first argument as a
`\fIpostscript file\fP' and makes files ending in `\fBps\fP' or `\fBeps\fP' 
be completed\&. The last description says that all other arguments are
`\fIpage numbers\fP' but does not give possible completions\&.
.RE
.TP
\fB_cache_invalid\fP \fIcache_identifier\fP
This function returns 0 if the completions cache corresponding to the
given cache identifier needs rebuilding\&.  It determines this by
looking up the \fBcache\-policy\fP style for the current context, and
if it exists, runs the function of the same name, supplying the full
path to the relevant cache file as the only argument\&.
.RS
.PP
Example:
.PP
.RS
.nf
\fB_example_caching_policy () {
    # rebuild if cache is more than a week old
    oldp=( "$1"(Nmw+1) )
    (( $#oldp ))
}\fP
.fi
.RE
.RE
.TP
\fB_call_function\fP \fIreturn\fP \fIname\fP [ \fIargs\fP \&.\&.\&. ]
If a function \fIname\fP exists, it is called with the arguments
\fIargs\fP\&. Unless it is the empty string or a single hyphen,
\fIreturn\fP is taken as the name of a parameter and the return status
from the called function is stored in it\&.
The return value of \fB_call_function\fP itself is zero if the function
\fIname\fP exists and was called and non\-zero otherwise\&.
.TP
\fB_call_program\fP \fItag\fP \fIstring\fP \&.\&.\&.
This function is used in places where a command is called, making it
possible for the user to override the default command call\&.  It looks up
the \fBcommand\fP style with the supplied \fItag\fP\&.  If the style is set, its
value is used as the command to execute\&.
.RS
.PP
In any case, the \fIstring\fPs from the call to \fB_call_program\fP or from the
style are concatenated with spaces between them and the resulting
string is evaluated\&.  The return value is the return value of the
command called\&.
.RE
.TP
\fB_combination\fP [ \fB\-s\fP \fIpattern\fP ] \fItag\fP \fIstyle\fP \fIspecs\fP \&.\&.\&. \fIfield\fP \fIopts\fP \&.\&.\&.
This function is used to complete combinations of values such as pairs 
of hostnames and usernames\&.  The possible values will be taken from the 
\fIstyle\fP whose name is given as the second argument\&.  The first argument
is the \fItag\fP to use to do the lookup\&.
.RS
.PP
The style name should consist of multiple parts separated by
hyphens which are then used as field names\&.  Known values for such
fields can be given after the second argument in arguments of the form 
`\fIfield\fP\fB=\fP\fIpattern\fP'\&.  The first argument without an equals sign 
is taken as the name of the field for which completions should be
generated\&.
.PP
The matches generated will be taken from the value of the style\&.  These 
values should contain the possible values for the combinations where
the values for the different fields are separated by colons or
characters matching the pattern given after the \fB\-s\fP option to
\fB_combination\fP; normally this is used to define character classes
like the `\fB\-s "[:@]"\fP' used for the \fBusers\-hosts\fP style\&.
.PP
Only the values for the requested fields for which the patterns given
in the `\fIfield\fP\fB=\fP\fIpattern\fP' match the respective fields in
the strings from the style value are generated as possible matches\&.
.PP
If no style with the given name is defined for the given tag but a
function named with the name of the requested field preceded by an
underscore is defined, that function will be called to generate the
matches\&.  This is also done if none of the strings in the value of the
style match all the patterns given as arguments\&.
.PP
If the same name is used for more than one field, in both the
`\fIfield\fP\fB=\fP\fIpattern\fP' and the argument that gives the field
name to complete for, the number of the field (starting with one) may
be given after the fieldname, separated from it by a colon\&.
.PP
All arguments after the requested field name are passed to
\fBcompadd\fP when generating matches from the style value, or to 
the functions for the fields if they are called\&.
.RE
.TP
\fB_contexts\fP \fInames\fP \&.\&.\&.
This function looks up the definitions for the context and command
names given as arguments and calls the handler functions for them if
there is a definition (given with the \fBcompdef\fP function)\&.  For
example, the function completing inside subscripts might use
`\fB_contexts \-math\-\fP' to include the completions generated for
mathematical environments\&.
.TP
\fB_describe\fP [ \fB\-o\fP ] \fIdescr\fP \fIname1\fP [ \fIname2\fP ] \fIopts\fP \&.\&.\&. \fB\-\fP\fB\-\fP \&.\&.\&.
This function is useful for preparing a list of command options or
arguments, together with their descriptions \fIdescr\fP, as matches\&.
Multiple groups separated by \fB\-\fP\fB\-\fP can be supplied, potentially with
different completion options \fIopts\fP\&.
.RS
.PP
The \fIdescr\fP is taken as a string to display above the matches if the
\fBformat\fP style for the \fBdescriptions\fP tag is set\&.  After this come one
or two names of arrays followed by options to pass to \fBcompadd\fP\&.  The
first array contains the possible completions with their descriptions in
the form `\fIcompletion\fP\fB:\fP\fIdescription\fP'\&.  If a second array is
given, it should have the same number of elements as the first one and the
corresponding elements are added as possible completions instead of the
\fIcompletion\fP strings from the first array\&.  The completion list will
retain the descriptions from the first array\&.  Finally, a set of completion
options can appear\&.
.PP
If the option `\fB\-o\fP' appears before the first argument, the matches added
will be treated as option names (typically following a `\fB\-\fP',
`\fB\-\fP\fB\-\fP' or `\fB+\fP' on the command line)\&.  This makes \fB_describe\fP use
the \fBprefix\-hidden\fP, \fBprefix\-needed\fP and \fBverbose\fP styles to find out
if the strings should be added at all and if the descriptions should be
shown\&.  Without the `\fB\-o\fP' option, only the \fBverbose\fP style is used\&.
.PP
\fB_describe\fP uses the \fB_all_labels\fP function to generate the matches, so
it does not need to appear inside a loop over tag labels\&.
.RE
.TP
\fB_description\fP [ \fB\-12VJ\fP ] \fItag\fP \fIname\fP \fIdescr\fP [ \fIspecs\fP \&.\&.\&. ]
This function is called before completions are added (typically by a call
to \fBcompadd\fP); it tests various styles and arranges for any necessary
options to be passed on to \fBcompadd\fP\&.  The styles are tested in the
current context using the given \fItag\fP; options are put into the array
called \fIname\fP for passing on to \fBcompadd\fP; the description for the
current set of matches is passed in \fIdescr\fP\&.  The styles tested are:
\fBformat\fP (which is first tested for the given \fItag\fP and then for the
\fBdescriptions\fP tag if that isn't defined), \fBhidden\fP, \fBmatcher\fP,
\fBignored\-patterns\fP and \fBgroup\-name\fP (the last are tested only for the
tag given as the first argument)\&.  This function also calls the \fB_setup\fP
function which tests some more styles\&.
.RS
.PP
The string returned by the \fBformat\fP style (if any) will be modified so
that the sequence `\fB%d\fP' is replaced by the \fIdescr\fP given as the third
argument without any leading or trailing white space\&.  If, after
removing the white space, the \fIdescr\fP is the empty string, the format
style will not be used and the options put into the \fIname\fP array will
not contain an explanation string to be displayed above the matches\&.  If
\fB_description\fP is called with more than three arguments,
the additional \fIspecs\fP should be of the form `\fIchar\fP\fB:\fP\fIstr\fP'
and every appearance of `\fB%\fP\fIchar\fP' in the format string will be
replaced by \fIstring\fP\&.
.PP
The options placed in the array will also make sure that the matches
are placed in a separate group, depending on the value of the
\fBgroup\-name\fP style\&.  Normally a sorted group will be used for this
(with the `\fB\-J\fP' option), but if an option starting with `\fB\-V\fP',
`\fB\-J\fP', `\fB\-1\fP', or `\fB\-2\fP' is given, that option will be included
in the array, so that it is possible to make the group unsorted by
giving the option `\fB\-V\fP', `\fB\-1V\fP', or `\fB\-2V\fP'\&. 
.PP
In most cases, the function will be used like this:
.PP
.RS
.nf
\fBlocal expl
_description files expl file
compadd "$expl[@]" \- "$files[@]"\fP
.fi
.RE
.PP
Note the use of the parameter \fBexpl\fP, the hyphen, and the list of
matches\&.  Almost all calls to \fBcompadd\fP within the completion system use
a similar format; this ensures that user\-specified styles are correctly
passed down to the builtins which implement the internals of completion\&.
.RE
.TP
\fB_files\fP
The function \fB_files\fP uses the \fBfile\-patterns\fP style and calls
\fB_path_files\fP with all the arguments it was passed except for \fB\-g\fP 
and \fB\-/\fP\&.  These two options are used depending on the setting of the 
\fBfile\-patterns\fP style\&.
.RS
.PP
See \fB_path_files\fP below for a description of the full set of options
accepted by \fB_files\fP\&.
.RE
.TP
\fB_gnu_generic\fP
This function is a simple wrapper around the \fB_arguments\fP function
described above\&.  It can be used to automatically complete long
options for commands that understand the `\fB\-\fP\fB\-help\fP' option\&.
It is not intended to be used from completion functions but as a
top\-level completion function in its own right\&.  For example, to
enable option completion for the commands \fBfoo\fP and \fBbar\fP, one
would call:
.RS
.PP
.RS
.nf
\fBcompdef _gnu_generic foo bar\fP
.fi
.RE
.PP
in one of the initialization files after the call to \fBcompinit\fP\&.
.PP
The default installation uses this function only to generate
completions for some GNU\-commands because to complete the options, the 
command has to be called and hence it shouldn't be used if one can't
be sure that the command understands the `\fB\-\fP\fB\-help\fP' option\&.
.RE
.TP
\fB_guard\fP [ \fIoptions\fP ] \fIpattern\fP [ \fIdescr\fP ]
This function is intended to be used in an action of functions like
\fB_arguments\fP\&.  It returns immediately with a non\-zero return value if
the string to be completed does not match the \fIpattern\fP\&.  If the
pattern matches, the \fIdescr\fP is displayed and the function returns
zero if the word to complete is not empty and non\-zero otherwise\&.
.RS
.PP
The \fIpattern\fP may be preceded by those options understood by
\fBcompadd\fP that are passed down from \fB_description\fP, namely \fB\-M\fP,
\fB\-J\fP, \fB\-V\fP, \fB\-1\fP, \fB\-2\fP, \fB\-n\fP, \fB\-F\fP and \fB\-X\fP\&.  All of these
options, except \fB\-X\fP, will be ignored\&.  If the \fB\-X\fP option appears,
the description following it will be used as the string to display if
the \fIpattern\fP matches, unless the option \fIdescr\fP is given to
\fB_guard\fP itself, which will then take precedence\&.
.PP
As an example, consider a command taking the options \fB\-n\fP and
\fB\-none\fP, where \fB\-n\fP has to be followed by a numeric value in the
same word\&.  By using either of:
.PP
.RS
.nf
\fB_argument '\-n\-:numeric value:_guard "[0\-9]#"' '\-none'\fP
.fi
.RE
.PP
or
.PP
.RS
.nf
\fB_argument '\-n\-: :_guard "[0\-9]#" "numeric value"' '\-none'\fP
.fi
.RE
.PP
\fB_arguments\fP can be made to both display the message `\fBnumeric
value\fP' and complete options after `\fB\-n<TAB>\fP'\&.  If the `\fB\-n\fP' is
already followed by one or more digits (matching the pattern given to
\fB_guard\fP), only the message will be displayed and if the `\fB\-n\fP' is
followed by another character, only options are completed\&.
.RE
.TP
\fB_message\fP [ \-r ] \fIdescr\fP
The \fIdescr\fP is used like the third
argument to the \fB_description\fP function\&. However, the resulting
string will always be shown whether or not matches were
generated\&. This is useful to display help texts in places where no
completions can be generated automatically\&.
.RS
.PP
This function also uses the \fBformat\fP style for the \fBmessages\fP tag in
preference to the \fBformat\fP style for the \fBdescriptions\fP tag\&. The
latter is used only if the former is unset\&.
.PP
If the \fB\-r\fP option is given, no style is used and the \fIdescr\fP is
used literally as the string to display\&. This is only used in cases
where that string is taken from some pre\-processed argument list
containing an expanded description\&.
.RE
.TP
\fB_multi_parts\fP \fIsep\fP \fIarray\fP
This function receives two arguments: a separator character and an
array\&.  As usual, the \fIarray\fP may be either the
name of an array parameter or a literal array in the form
`\fB(foo bar\fP\fB)\fP' (i\&.e\&. a list of words separated by white 
space in parentheses)\&.  With these arguments, this function will
complete to strings from the array where the parts separated by the
separator character are completed independently\&.  For example, the
\fB_tar\fP function from the distribution caches the pathnames from the
tar file in an array, and then calls this function to complete these
names in the way normal filenames are completed by the
\fB_path_files\fP function, by using `\fB_multi_parts\fP \fB/\fP
\fIpatharray\fP'\&.
.RS
.PP
If the \fB\-i\fP option is present, then any time there is a unique match it
will immediately be inserted even if that requires additional separators to
be inserted as well\&.  When completing from a fixed set of possible
completions which are really words, this is often the expected behaviour;
however, if \fB_multi_parts\fP should behave like completing pathnames, the
\fB\-i\fP option should not be used\&.
.PP
Like other utility functions, this function accepts the `\fB\-V\fP',
`\fB\-J\fP', `\fB\-1\fP', `\fB\-2\fP', `\fB\-n\fP', `\fB\-f\fP', `\fB\-X\fP', `\fB\-M\fP',
`\fB\-P\fP', `\fB\-S\fP', `\fB\-r\fP', `\fB\-R\fP', and `\fB\-q\fP' options and passes
them to the \fBcompadd\fP builtin\&.
.RE
.TP
\fB_next_label\fP [ \fB\-12VJ\fP ] \fItag\fP \fIname\fP \fIdescr\fP [ \fIoptions\fP \&.\&.\&. ]
This function should be called repeatedly to generate the tag
labels\&. On each call it will check if another tag label is to be used 
and, if there is at least one, zero is returned\&. If no more tag
labels are to be used, a non\-zero status is returned\&.
.RS
.PP
The \fB\-12JV\fP options and the first three arguments are given to the
\fB_description\fP function using the tag label instead of the first
argument as appropriate\&. The \fIoptions\fP given after the \fIdescr\fP
should be other options to be used for \fBcompadd\fP or whatever
function is to be called to add the matches\&. \fB_next_label\fP will store these 
\fIoptions\fP in the parameter whose \fIname\fP is given as the second
argument\&. This is done in such a way that the description given by the 
user to the \fBtag\-order\fP style is preferred over the one given to
\fB_next_label\fP\&.
.PP
Note that this function must not be called without a previous call to
\fB_tags\fP or \fB_requested\fP because it uses the tag label
for the current tag found by these functions\&.
.PP
A normal use of this function for the tag labels of the tag \fBfoo\fP
looks like this:
.PP
.RS
.nf
\fBlocal expl ret=1
\&.\&.\&.
if _requested foo; then
  \&.\&.\&.
  while _next_label foo expl '\&.\&.\&.'; do
    compadd "$expl[@]" \&.\&.\&. && ret=0
  done
  \&.\&.\&.
fi
return ret
\fP
.fi
.RE
.RE
.TP
\fB_normal\fP
This function is used for normal command completion\&.  It has two tasks:
completing the first word on the command line as the name of a command, and
completing the arguments to this command\&.  In the second case, the name of
the command is looked up to see if special completions exists, including
completions defined for patterns which match the name\&.  If none is found,
completion is performed for the context \fB\-default\-\fP\&.
.RS
.PP
The function can also be called by other completion functions which need to
treat a range of words as a command line\&.  For example, the function to
complete after the pre\-command specifiers such as \fBnohup\fP removes the
first word from the \fBwords\fP array, decrements the \fBCURRENT\fP parameter,
then calls \fB_normal\fP again, with the effect that `\fBnohup\fP \fIcmd \&.\&.\&.\fP'
is treated the same way was `\fIcmd \&.\&.\&.\fP'\&.
.PP
If the command name matches a pattern, the parameter \fB_compskip\fP is
checked after the call to the corresponding completion function\&.  This has
the same effect here as in the \fB\-first\-\fP context: if it is set, no more
completion functions are called even if there are no matches so far\&.
.RE
.TP
\fB_options\fP
This can be used to complete option names\&.  It uses a matching
specification that ignores a leading `\fBno\fP', ignores underscores and 
allows the user to type upper\-case letters which will match their
lower\-case counterparts\&.  All arguments passed to this function are
propagated unchanged to the \fBcompadd\fP builtin\&.
.TP
\fB_options_set\fP and \fB_options_unset\fP
These functions complete only set or unset options, with the same
matching specification used in the \fB_options\fP function\&.
.RS
.PP
Note that you need to uncomment a few lines in the \fB_main_complete\fP
function for these functions to work properly\&.  The lines in question
are used to store the option settings in effect before the completion
widget locally sets the options it needs\&.  Hence these options are not
generally used by the completion system\&.
.RE
.TP
\fB_parameters\fP
This should be used to complete parameter names\&.  \fB_parameters\fP can
take a \fB\-g \fIpattern\fP\fP option which specifies that only parameters
whose type matches the \fIpattern\fP should be completed\&.  Strings of
the same form as those returned by the \fBt\fP parameter expansion flag
are used here when matching the type\&.  All other arguments are passed
unchanged to the \fBcompadd\fP builtin\&.
.TP
\fB_path_files\fP
The function \fB_path_files\fP is used throughout the completion system
to complete filenames\&.  It allows completion of partial paths\&.  For
example, the string `\fB/u/i/s/sig\fP' may be completed to
`\fB/usr/include/sys/signal\&.h\fP'\&.
.RS
.PP
The options accepted by both \fB_path_files\fP and \fB_files\fP are:
.PP
.PD 0
.TP
.PD
\fB\-f\fP
Complete all filenames\&.  This is the default\&.
.TP
\fB\-/\fP
Specifies that only directories should be completed\&.
.TP
\fB\-g\fP \fIpattern\fP
Specifies that only files matching the \fIpattern\fP should be completed\&.
.TP
\fB\-W\fP \fIpaths\fP
Specifies path prefixes that are to be prepended to the string from the
line to generate the filenames but that should not be inserted in the line
or shown in a completion listing\&.  Here, \fIpaths\fP may be the name of an
array parameter, a literal list of paths enclosed in parentheses or an
absolute pathname\&.
.TP
\fB\-F\fP
This option from the \fBcompadd\fP builtin gives direct control over which
filenames should be ignored\&.  If the option is not present, the
\fBignored\-patterns\fP style is used\&.
.PP
These functions also accept the `\fB\-J\fP', `\fB\-V\fP', `\fB\-1\fP',
`\fB\-2\fP', `\fB\-n\fP', `\fB\-X\fP', `\fB\-M\fP', `\fB\-P\fP', `\fB\-S\fP', `\fB\-q\fP',
`\fB\-r\fP', and `\fB\-R\fP' options from the \fBcompadd\fP builtin\&.
.PP
Finally, the \fB_path_files\fP function  uses the styles \fBexpand\fP,
\fBambiguous\fP, \fBspecial\-dirs\fP, \fBlist\-suffixes\fP and \fBfile\-sort\fP\&.
.RE
.TP
\fB_regex_arguments\fP \fIname\fP \fIspecs\fP \&.\&.\&.
This function is a compiler to generate a completion function\&.  The
first argument specifies the name of the generated function while the
remaining arguments specify a completion as a set of regular
expressions with actions\&.  The generated function has the structure of a
finite\-state machine whose states correspond to the state (i\&.e\&. the
context) of the completion\&. This state machine uses a command line,
which comes from the concatenation of the \fBwords\fP array up to the
current cursor position using null characters as separators with no extra
quotation\&.  This is analysed and at the end the appropriate action is
executed\&.
.RS
.PP
Specification arguments take one of following forms, in which
metacharacters such as `\fB(\fP', `\fB)\fP', `\fB#\fP' and `\fB|\fP'
should be quoted\&.
.PP
.PD 0
.TP
.PD
\fB/\fP\fIpattern\fP\fB/\fP [\fB%\fP\fIlookahead\fP\fB%\fP] [\fB\-\fP\fIguard\fP] [\fB:\fP\fItag\fP\fB:\fP\fIdescr\fP\fB:\fP\fIaction\fP]
This is a primitive element, corresponding to one
state of the compiled state machine\&.  The state is entered if
`\fB(#b)((#B)\fP\fIpattern\fP\fB)(#B)\fP\fIlookahead\fP\fB*\fP' matches
the command line string\&.  If it matches, `\fIguard\fP' is evaluated and
its return status is examined; if this is successful, the state is entered,
otherwise the test fails and other candidates are tried\&.  The \fIpattern\fP
string `\fB[]\fP' is guaranteed never to match\&.
.RS
.PP
If the test succeeds and the state is entered, the left part of the
command line string matched as \fIpattern\fP is removed and the 
next state is tried, proceeding from inside to outside and from left to
right\&.
.PP
If no test succeeds and the remaining command line string contains no null
character, the completion target is restricted to the remainder of the
command line string and \fIaction\fPs for the target are executed\&.
In this case, nothing is actually removed from the command line string
so that any previous or neighbouring state may also have \fIactions\fPs\&.
\fIactions\fPs evaluation are ordered by the \fBtag\-order\fP style and specified
\fItag\fP by \fB_alternative\fP\&.  So, the various formats supported by
\fB_alternative\fP can be used in \fIaction\fP\&.  \fIdescr\fP is used for
setting up the array parameter \fBexpl\fP\&.
.RE
.TP
\fB/\fP\fIpattern\fP\fB/+\fP [\fB%\fP\fIlookahead\fP\fB%\fP] [\fB\-\fP\fIguard\fP] [\fB:\fP\fItag\fP\fB:\fP\fIdescr\fP\fB:\fP\fIaction\fP]
This is similar to `\fB/\fP\fIpattern\fP\fB/\fP \&.\&.\&.' but the left part of the
command line string is also considered as part of the completion target\&.
.TP
\fB/\fP\fIpattern\fP\fB/\-\fP [\fB%\fP\fIlookahead\fP\fB%\fP] [\fB\-\fP\fIguard\fP] [\fB:\fP\fItag\fP\fB:\fP\fIdescr\fP\fB:\fP\fIaction\fP]
This is similar to `\fB/\fP\fIpattern\fP\fB/\fP \&.\&.\&.' but the \fIaction\fPs of the
current and previous states are ignored even if the following state's
`\fIpattern\fP' matches the empty string\&.
.TP
\fB(\fP \fIspec\fP \fB)\fP
This groups \fIspec\fPs\&.
.TP
\fIspec\fP \fB#\fP
This allows any number of repetitions of \fIspec\fP\&.
.TP
\fIspec\fP \fIspec\fP
This represents the concatenation of two \fIspec\fPs\&.
.TP
\fIspec\fP \fB|\fP \fIspec\fP
Either of the two \fIspec\fPs can be matched\&.
.RE
.TP
\fB_requested\fP [ \fB\-12VJ\fP ] \fItag\fP [ \fIname\fP \fIdescr\fP [ \fIcommand\fP \fIargs\fP \&.\&.\&. ] ]
This function is called to decide whether a tag already registered by a
call to \fB_tags\fP (see below) is requested and hence completion should be
performed for it; it returns status zero if the tag is requested and
non\-zero otherwise\&.  This will usually be done in a loop such as the
following:
.RS
.PP
.RS
.nf
\fB_tags foo bar baz
while _tags; do
  if _requested foo; then
    \&.\&.\&. # perform completion for foo
  fi
  \&.\&.\&. # test the tags bar and baz in the same way
  \&.\&.\&. # exit loop if matches were generated
done\fP
.fi
.RE
.PP
Note that the test for whether matches were generated is not performed
until the end of the \fB_tags\fP loop\&.  This is so that the user can specify
a set of tags to be tested at the same time in the \fBtag\-order\fP
parameter\&.
.PP
If the \fIname\fP and the \fIdescr\fP are given, \fB_requested\fP calls the
\fB_description\fP function with these arguments, including the options\&.
.PP
If the \fIcommand\fP is given, the \fB_all_labels\fP function will be called
immediately with the same arguments\&.  This is often useful to do both the
testing of the tag, getting the description for the matches and adding the
matches at once\&.  For example:
.PP
.RS
.nf
\fBlocal expl ret=1
_tags foo bar baz
while _tags; do
  _requested foo expl 'description' \e 
      compadd foobar foobaz && ret=0
  \&.\&.\&.
  (( ret )) || break
done\fP
.fi
.RE
.PP
Note that this means that the \fIcommand\fP has to accept the options
that have to be passed down to \fBcompadd\fP\&.
.RE
.TP
\fB_retrieve_cache\fP \fIcache_identifier\fP
This function retrieves completion information from the file given by
\fIcache_identifier\fP, stored in a directory specified by the
\fBcache\-path\fP style (defaults to \fB~/\&.zsh/cache\fP)\&.  The return value
is zero if retrieval was successful\&.  It will only attempt retrieval
if the \fBuse\-cache\fP style is set, so you can call this function
without worrying about whether the user wanted to use the caching
layer\&.
.RS
.PP
See \fB_store_cache\fP below for more details\&.
.RE
.TP
\fB_sep_parts\fP
This function is passed alternating arrays and separators as arguments\&.
The arrays specify completions for parts of strings to be separated by the
separators\&.  The arrays may be the names of array parameters or
a quoted list of words in parentheses\&.  For example, with the array
`\fBhosts=(ftp news)\fP' the call `\fB_sep_parts '(foo bar)' @ hosts\fP' will
complete the string  `\fBf\fP' to `\fBfoo\fP' and the string `\fBb@n\fP' to
`\fBbar@news\fP'\&.
.RS
.PP
This function passes the `\fB\-V\fP', `\fB\-J\fP', `\fB\-1\fP', `\fB\-2\fP',
`\fB\-n\fP', `\fB\-X\fP', `\fB\-M\fP', `\fB\-P\fP', `\fB\-S\fP', `\fB\-r\fP', `\fB\-R\fP',
and `\fB\-q\fP' options and their arguments to the \fBcompadd\fP builtin
used to add the matches\&.
.RE
.TP
\fB_setup\fP \fItag\fP [ \fIgroup\fP ]
This function expects a tag as its argument and sets up the special
parameters used by the completion system appropriately for the tag,
using styles such as \fBlist\-colors\fP and \fBlast\-prompt\fP\&.
.RS
.PP
The optional \fIgroup\fP gives the name of the group in which the
matches will be placed\&. If it is not given, the \fItag\fP is used as
the group name\&.
.PP
Note that this function is called automatically from \fB_description\fP
so that one normally doesn't have to call it explicitly\&.
.RE
.TP
\fB_store_cache\fP \fIcache_identifier\fP \fIvars\fP \&.\&.\&.
This function, when combined with \fB_retrieve_cache\fP and
\fB_cache_invalid\fP, makes it easy to implement a caching layer for
your completion functions\&.  If a completion function needs to perform
a costly operation in order to generate data which is used to
calculate completions, you can store that data in variables, and use
this function to dump the values of those variables to a file\&.  Then,
if they are needed in subsequent shell invocations, they can be
retrieved quickly from that file via \fB_retrieve_cache\fP, avoiding the
need for repeating the costly operation\&.
.RS
.PP
The \fIcache_identifier\fP specifies the file which the data should be
dumped to, and is stored in a directory specified by the
\fBcache\-path\fP style (defaults to \fB~/\&.zsh/cache\fP)\&.  The remaining
\fIvars\fP arguments are the variables to dump to the file\&.
.PP
The return value is zero if storage was successful\&.  The function will
only attempt storage if the \fBuse\-cache\fP style is set, so you can
call this function without worrying about whether the user wanted to
use the caching layer\&.
.PP
If your completion function avoids calling _retrieve_cache when it
already has the completion data in the environment, it should probably
at least call \fB_cache_invalid\fP to check whether this data and the
data cached on disk is still valid\&.
.PP
See the _perl_modules completion function for a simple example of
usage of this caching layer\&.
.RE
.TP
\fB_tags\fP [ \fB\-C\fP \fIname\fP [ \fItags\fP \&.\&.\&. ] ]
If called with arguments, these are taken as the names of the tags for 
the types of matches the calling completion function can generate in
the current context\&.  These tags are stored internally and sorted by
using the \fBtag\-order\fP style\&.  Following calls to this function
without arguments from the same function will then select the first,
second, etc\&. set of tags requested by the user\&.  To test if a certain
tag should be tried, the \fB_requested\fP function has to be called (see 
above)\&.
.RS
.PP
The return value is zero if at least one of the tags is requested and
non\-zero otherwise\&. 
.PP
This function also accepts the \fB\-C\fP option followed by a
\fIname\fP\&. This name is temporarily (i\&.e\&. not visible outside
\fB_tags\fP) stored in the argument field of the context name in the
\fBcurcontext\fP parameter\&. This allows \fB_tags\fP to be made to use a more
specific context name without having to change and reset the
\fBcurcontext\fP parameter (which would otherwise have the same effect)\&.
.RE
.TP
\fB_values\fP \fIspecs\fP \&.\&.\&.
This is used to complete values (strings) and their arguments or
lists of such values\&.  It can be used in two ways\&.
.RS
.PP
If the first argument is the option `\fB\-O\fP \fIname\fP', this will be used
in the same way as by the \fB_arguments\fP function, in other words the
elements of the \fIname\fP array will be given to calls to \fBcompadd\fP
and when executing an action\&.
.PP
Otherwise, if the first argument (or the first argument after the
`\fB\-O\fP \fIname\fP' option if that is used) is the option `\fB\-s\fP', the
next argument is used as the character that separates multiple values\&.
Thus the values completed appear in the same word on the command line,
unlike completion using \fB_arguments\fP\&.
.PP
The first argument (after the options and separator character if they
are given) is used as a string to print as a description before
listing the values\&.
.PP
All other arguments describe the possible values and their
arguments in the same format used for the description of options by
the \fB_arguments\fP function (see above)\&.  The only differences are that
no minus or plus sign is required at the beginning, that
values can have only one argument and that those forms of actions
beginning with an equal sign are not supported\&.
.PP
The character separating a value from its argument can be set using the
option \fB\-S\fP (like \fB\-s\fP, followed by the character to use as the
separator in the next argument)\&.  If this option is not used, the equal
sign will be used as the separator\&.
.PP
Example:
.PP
.RS
.nf
\fB_values \-s , 'description' \e 
        '*foo[bar]' \e 
        '(two)*one[number]:first count:' \e 
        'two[another number]::second count:(1 2 3)'\fP
.fi
.RE
.PP
This describes three possible values: `\fBfoo\fP', `\fBone\fP', and
`\fBtwo\fP'\&.  The first is described as `\fBbar\fP', takes no argument 
and may appear more than once\&.  The second is described as
`\fBnumber\fP', may appear more than once, and takes one mandatory
argument described as `\fBfirst count\fP' for which no action is
specified so that it will not be completed automatically\&.  The
`\fB(two)\fP' at the beginning says that if the value `\fBone\fP' is on
the line, the value `\fBtwo\fP' will not be considered to be a possible
completion anymore\&.  Finally, the last value (`\fBtwo\fP') is described
as `\fBanother number\fP' and takes an optional argument described as
`\fBsecond count\fP' which will be completed from the strings `\fB1\fP',
`\fB2\fP', and `\fB3\fP'\&. The \fB_values\fP function will complete lists of
these values separated by commas\&.
.PP
Like \fB_arguments\fP this function temporarily adds another context
name component to the current context name while executing the
\fIaction\fP\&.  Here this name is just the name of the value for which
the argument is completed\&.
.PP
To decide if the descriptions for the values (not those for the
arguments) should be printed, the style \fBverbose\fP is used\&.
.PP
One last difference from \fB_arguments\fP is that this function uses the
associative array
\fBval_args\fP to report values and their arguments, although otherwise this
is the same as the \fBopt_args\fP association used by
\fB_arguments\fP\&.  This also means that the function calling \fB_values\fP 
should declare the \fBstate\fP, \fBline\fP, \fBcontext\fP and \fBval_args\fP
parameters as in:
.PP
.RS
.nf
\fBlocal context state line
typeset \-A val_args\fP
.fi
.RE
.PP
when using an action of the form `\fB\->\fP\fIstring\fP'\&.  With this
function the \fBcontext\fP parameter will be set to the name of the
value whose argument is to be completed\&.
.PP
Note also that \fB_values\fP normally adds the character used as the
separator between values as an auto\-removable suffix so that users don't
have to type it themselves\&.  But when using a `\fB\->\fP\fIstring\fP' action
\fB_values\fP can't do that because the matches for the argument will be
generated by the calling function\&.  To get the usual behaviour, the
implementor of the calling function has to add the suffix directly by
passing the options `\fB\-qS\fP \fIx\fP' (where \fIx\fP is the separator
character specified with the \fB\-s\fP option of \fB_values\fP) to the
function generating the matches or to the \fBcompadd\fP builtin\&.
.PP
Like \fB_arguments\fP, \fB_values\fP supports the \fB\-C\fP option in
which case you have to make the parameter \fBcurcontext\fP local instead 
of \fBcontext\fP (as described above)\&.
.RE
.TP
\fB_wanted\fP [ \fB\-C\fP \fIname\fP ]  [ \fB\-12VJ\fP ] \fItag\fP \fIname\fP \fIdescr\fP \fIcommand\fP \fIargs\fP \&.\&.\&.
In many contexts, completion will generate one particular set of
matches (usually corresponding to a single tag); however, it is
still necessary to decide whether the user requires matches of this type\&.
This function is useful in such a case\&.
.RS
.PP
Like \fB_requested\fP, it should be passed arguments as for \fB_description\fP\&.
It calls \fB_tags\fP with the given \fItag\fP and if that returns zero 
(so that the \fItag\fP is requested by the user) it calls
\fB_description\fP\&.  Hence to offer only one tag and immediately
use the description generated:
.PP
.RS
.nf
\fB_wanted tag expl 'description' \e 
    compadd matches\&.\&.\&.\fP
.fi
.RE
.PP
Unlike \fB_requested\fP, however, \fB_wanted\fP cannot be called without
the \fIcommand\fP\&.  This is because \fB_wanted\fP also implements the loop
over the tags, not just the one for the labels; conversely, it should not
be called in the middle of a \fB_tags\fP loop\&.
.PP
Note that, as for \fB_requested\fP, the \fIcommand\fP has to accept the options
that have to be passed down to \fBcompadd\fP\&.
.PP
Like \fB_tags\fP this function supports the \fB\-C\fP option to give a
different name for the argument context field\&.
.RE
.RE
.PP
.SH "COMPLETION DIRECTORIES"
.PP
In the source distribution, the files are contained in various
subdirectories of the \fBCompletion\fP directory\&.  They may have been
installed in the same structure, or into one single function directory\&.
The following is a description of the files found in the original directory
structure\&.  If you wish to alter an installed file, you will need to copy
it to some directory which appears earlier in your \fBfpath\fP than the
standard directory where it appears\&.
.PP
.PD 0
.TP
.PD
\fBBase\fP
The core functions and special completion widgets automatically bound
to keys\&.  You will certainly need most of these, though will
probably not need to alter them\&.  Many of these are documented above\&.
.TP
\fBZsh\fP
Functions for completing arguments of shell builtin commands and
utility functions for this\&.  Some of these are also used by functions from
the \fBUnix\fP directory\&.
.TP
\fBUnix\fP
Functions for completing arguments of external commands and suites of
commands\&.  They may need modifying for your system, although in many cases
some attempt is made to decide which version of a command is present\&.  For
example, completion for the \fBmount\fP command tries to determine the system
it is running on, while completion for many other utilities try to decide
whether the GNU version of the command is in use, and hence whether the
\fB\-\-help\fP option is supported\&.\&.
.TP
\fBX\fP, \fBAIX\fP, \fBBSD\fP, \&.\&.\&.
Completion and utility function for commands available only on some systems\&.
